<app-navbar (toggleSidebar)="toggleSidebar()"></app-navbar>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" />


<style>
  .table td,
  .table th {
    text-align: left !important;
  }
</style>




<main id="main" class=" bg-gray  main mt-0 p-0"
  [ngClass]="{'full-width': isSidebarOpen, 'shift-right': !isSidebarOpen}">
  <div class="p-4 pb-0">
    <h2 style="margin-left: 85px;" class="font-18 font-weight-700 mb-4 text-capitalize">Driver List</h2>
    <div style="margin-left: 90px;" class="    bg-white rounded-lg p-3">
      <div class=" bg-styles  row bg-white px-3 mt-3 rounded">
        <div class="    col-md-12">





          <ul class="nav nav-pills gap-2 border-bottom pb-4" id="myTab" role="tablist">
            <li class="nav-item d-flex align-items-center gap-2" role="presentation">
              <button class="nav-link rounded-pill active bg-nav-info" id="home-tab" data-bs-toggle="tab"
                data-bs-target="#customer" type="button" role="tab" aria-controls="home" aria-selected="true"
                (click)="filterDrivers('all')">
                Driver List
                <span class="ms-1" [ngStyle]="{'color': activeFilter === 'all' ? '#ffffff' : '#3253dd'}">
                  ({{ totalDrivers }})
                </span>
              </button>
            </li>

            <li class="nav-item d-flex align-items-center gap-2" role="presentation">
              <button class="nav-link rounded-pill bg-nav-success" id="home-tab" data-bs-toggle="tab"
                data-bs-target="#customer" type="button" role="tab" aria-controls="home" aria-selected="true"
                (click)="filterDrivers('compliant')">
                Compliant Drivers
                <span class="ms-1" [ngStyle]="{'color': activeFilter === 'compliant' ? '#ffffff' : '#28c76f'}">
                  ({{ compliantDrivers }})
                </span>
              </button>
            </li>

            <li class="nav-item d-flex align-items-center gap-2" role="presentation">
              <button class="nav-link rounded-pill bg-nav-warning" id="home-tab" data-bs-toggle="tab"
                data-bs-target="#customer" type="button" role="tab" aria-controls="home" aria-selected="true"
                (click)="filterDrivers('nonCompliant')">
                Non-Compliant Drivers
                <span class="ms-1" [ngStyle]="{'color': activeFilter === 'nonCompliant' ? '#ffffff' : '#ff9f43'}">
                  ({{ nonCompliantDrivers }})
                </span>
              </button>
            </li>

            <li class="nav-item d-flex align-items-center gap-2" role="presentation">
              <button class="nav-link rounded-pill bg-nav-danger" id="home-tab" data-bs-toggle="tab"
                data-bs-target="#customer" type="button" role="tab" aria-controls="home" aria-selected="true"
                (click)="filterDrivers('expiring')">
                Expiring Driver
                <span class="ms-1" [ngStyle]="{'color': activeFilter === 'expiring' ? '#ffffff' : '#ea5455'}">
                  ({{ expiringDrivers }})
                </span>
              </button>
            </li>
          </ul>


          <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade active show" id="customer" role="tabpanel" aria-labelledby="home-tab">
              <div id="kt_app_content" class="app-content  flex-column-fluid">
                <div class="my-4">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="d-flex justify-content-between">
                        <div class="form-group has-search mb-0 d-flex">
                          <span class="fa fa-search form-control-feedback"></span>
                          <input style="height: 36px !important; padding-left: 30px; margin-right: 10px;" type="text"
                            name="Search" class="form-control"
                            placeholder="Search by Driver Name, Email, or Company Name..." [(ngModel)]="searchTerm">
                          <button class="btn btn-success rounded-pill font-14 search-btn" (click)="searchDrivers()">
                            <i class="bi bi-search"></i> Search
                          </button>
                        </div>
                        <div>
                          <a href="javascript:;" class="btn btn-success rounded-pill font-14" type="button"
                            data-bs-toggle="offcanvas" data-bs-target="#addLocation" aria-controls="offcanvasRight"><i
                              class="fa fa-plus me-2" aria-hidden="true"></i>Add Driver</a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col-lg-12">
                    <div class="table-responsive">
                      <table class=" gap table table-bordered" style="text-align: left;">
                        <thead>
                          <tr>
                            <th scope="col">Sr. No</th>
                            <th scope="col">Driver Name</th>
                            <th scope="col">Email</th>
                            <th scope="col">Phone</th>
                            <th scope="col">Company Name</th>
                            <!-- <th scope="col">Truck No</th> -->
                            <th scope="col">License No</th>
                            <th scope="col">Activation Date</th>
                            <th scope="col">Status</th>
                            <!-- <th scope="col">Active</th> -->
                            <th scope="col" width="30px">Actions</th>
                          </tr>
                        </thead>

                        <tbody>
                          <tr *ngFor="let driver of paginatedDrivers; let i = index">
                            <td class="text-center serial-number">
                              {{ (currentPage - 1) * itemsPerPage + i + 1 }}
                              <i class="fa fa-star text-warning" aria-hidden="true"></i>
                            </td>
                            <td>
                              <a class="text-primary" [routerLink]="['/driver-profile-view', driver._id]">
                                {{ driver.firstName }} {{ driver.middleName }} {{ driver.lastName }}
                              </a>
                            </td>
                            <td>{{ driver.email }}</td>
                            <td>{{ driver.phone }}</td>
                            <td>{{ findCompanyName(driver.companyId) }}</td>
                            <td>{{ driver.currentCdlNumber }}</td>
                            <td>{{ driver.activeDate | date:'MM-dd-yyyy' }}</td>
                            <td>
                              <span class="badge font-13 font-weight-700 text-uppercase" [ngClass]="{
                          'bg-label-success': driver.status === 'APPROVED',
                        'bg-label-warning': driver.status === 'PENDING',
                        'bg-label-danger': driver.status === 'EXPIRING'
                              }">
                                {{ driver.status }}
                              </span>
                            </td>
                            <td class="text-capitalize">
                              <div class="dropdown filter-dropdown">
                                <span class="dropdown-toggle font-16 px-3" type="button" id="dropdownMenuButton23"
                                  data-bs-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i>
                                </span>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
                                  <a href="javascript:;" class="dropdown-item assigned font-13"
                                    (click)="editDriver(driver)" type="button" data-bs-toggle="offcanvas"
                                    data-bs-target="#ExtralargeModalEdit" aria-controls="offcanvasRight">Edit</a>
                                  <a class="dropdown-item assigned font-13" href="javascript:;" data-bs-toggle="modal"
                                    data-bs-target="#ExtralargeModalDelete"
                                    (click)="setDriverToDelete(driver._id)">Delete</a>
                                </div>
                              </div>
                            </td>
                          </tr>
                        </tbody>
                        <!-- ...existing code... -->
                      </table>
                    </div>
                  </div>
                </div>
                <div class="bg-white my-3 rounded pb-3 " style="margin-right: 90px;">
                  <div class="row">
                    <div class="col-md-12">
                      <nav aria-label="Page navigation example ms-auto me-auto">
                        <ul class="pagination justify-content-center gap-2 mb-0">
                          <li class="page-item" [class.disabled]="currentPage === 1">
                            <a class="page-link font-22 d-flex align-items-center justify-content-center"
                              href="javascript:;" aria-label="Previous" (click)="changePage(currentPage - 1)"><i
                                class="fa fa-angle-left font-weight-300"></i></a>
                          </li>
                          <li class="page-item" *ngFor="let page of getPageNumbers()"
                            [class.active]="currentPage === page">
                            <a class="page-link font-14 d-flex align-items-center justify-content-center"
                              href="javascript:;" (click)="changePage(page)">{{ page }}</a>
                          </li>
                          <li class="page-item" [class.disabled]="currentPage === getTotalPages()">
                            <a class="page-link font-22 d-flex align-items-center justify-content-center"
                              href="javascript:;" aria-label="Next" (click)="changePage(currentPage + 1)"><i
                                class="fa fa-angle-right font-weight-300"></i></a>
                          </li>
                        </ul>
                      </nav>
                      <!-- Added: Showing entries info below pagination -->
                      <div class="text-center mt-2">
                        <ng-container *ngIf="paginatedDrivers.length > 0">
                          <span class="badge bg-light text-dark px-3 py-2"
                            style="font-size: 14px; font-weight: normal;">
                            Showing
                            {{
                            ((currentPage - 1) * itemsPerPage) + 1
                            }}
                            to
                            {{
                            ((currentPage - 1) * itemsPerPage) + paginatedDrivers.length
                            }}
                            of
                            {{
                            activeFilter === 'all' ? filteredDrivers.length :
                            activeFilter === 'compliant' ? compliantDrivers :
                            activeFilter === 'nonCompliant' ? nonCompliantDrivers :
                            activeFilter === 'expiring' ? expiringDrivers : 0
                            }}
                            entries (Page {{ currentPage }} of {{ getTotalPages() }})
                          </span>
                        </ng-container>
                        <ng-container *ngIf="paginatedDrivers.length === 0">
                          <span class="badge bg-light text-danger px-3 py-2" style="font-size: 14px;">
                            No records to display.
                          </span>
                        </ng-container>
                      </div>
                      <!-- End added block -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>
<!-- End #main -->
<footer id="footer" class="footer text-center"
  [ngClass]="{'full-widths': isSidebarOpen, 'shift-rights': !isSidebarOpen}">
  <div class="text-dark">
    <span class="text-muted fw-semibold me-1">2025© all rights reserved</span>
    <a class="font-weight-700 text-hover-dark text-dark text-uppercase">3PL TEK INC.</a>
  </div>
</footer>





<a href="#" class="back-to-top d-flex align-items-center justify-content-center btn-success">
  <i class="bi bi-arrow-up-short"></i>
</a>

<div class="offcanvas offcanvas-end" id="addLocation" aria-labelledby="offcanvasRightLabel" style="width: 80%;"
  data-bs-backdrop="static">
  <div class="modal-header" style="padding: 15px; border-bottom: 1px solid #ccc;">
    <h5 class="modal-title">Add Driver</h5>
    <div>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
  </div>

  <div class="offcanvas-body view-load position-relative">
    <form class="row g-3" (ngSubmit)="submitForm(f)" #f="ngForm">

      <div class="sidebar_ac">
        <h3 class="text-black text-center">Company Form</h3>
        <ul style="margin-left: 15px;">
          <li [ngClass]="{'active-option': activeSection === 'personal-info'}">
            <a href="#" class="toggle-section"
              (click)="goToSection('personal-info' , $event); $event.preventDefault();">

              Driver Information
            </a>
          </li>
          <li [ngClass]="{'active-option': activeSection === 'driving-info'}">
            <a href="#" class="toggle-section" (click)="goToSection('driving-info' , $event); $event.preventDefault();">
              Driving Experience
            </a>
          </li>
          <li [ngClass]="{'active-option': activeSection === 'employment-history'}">
            <a href="#" class="toggle-section"
              (click)="goToSection('employment-history', $event); $event.preventDefault();">

              Employment History
            </a>
          </li>
          <li [ngClass]="{'active-option': activeSection === 'document-info'}">
            <a href="#" class="toggle-section"
              (click)="goToSection('document-info' , $event); $event.preventDefault();">

              Document Information
            </a>
          </li>
        </ul>
      </div>

      <!-- Personal Information Section -->
      <div class="content_ac" *ngIf="activeSection === 'personal-info'">
        <!-- <h3 class="mb-4">Personal Information</h3> -->

        <h4 class="mt-4 mb-3 border-bottom pb-2">APPLICANT INFORMATION</h4>

        <div class="row">
          <div class="col-md-3">
            <label>Driver First Name</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.firstName" name="firstName" required
              pattern="^[a-zA-Z\s]*$" maxlength="30" #firstNameModel="ngModel">
            <div *ngIf="firstNameModel.invalid && (firstNameModel.dirty || firstNameModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="firstNameModel.errors?.['required']">First Name is required.</span>
              <span *ngIf="firstNameModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Driver Middle Name</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.middleName" name="middleName"
              pattern="^[a-zA-Z\s]*$" maxlength="30" #middleNameModel="ngModel">
            <div *ngIf="middleNameModel.invalid && (middleNameModel.dirty || middleNameModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="middleNameModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Driver Last Name</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.lastName" name="lastName" required
              pattern="^[a-zA-Z\s]*$" maxlength="30" #lastNameModel="ngModel">
            <div *ngIf="lastNameModel.invalid && (lastNameModel.dirty || lastNameModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="lastNameModel.errors?.['required']">Last Name is required.</span>
              <span *ngIf="lastNameModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Active Date</label>
            <input type="date" class="form-control" [(ngModel)]="newDriver.activeDate" name="activeDate"
              #activeDateModel="ngModel">
            <!-- Optional: Add required and validation if needed -->
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Date of Birth (DOB)</label>
            <input type="date" class="form-control" [(ngModel)]="newDriver.dob" name="dob" required #dobModel="ngModel">
            <div *ngIf="dobModel.invalid && (dobModel.dirty || dobModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="dobModel.errors?.['required']">DOB is required.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Phone</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.phone" name="phone" required
              pattern="^[0-9\-()\s]+$" maxlength="10" placeholder="(XXX) XXX-XXXX" #phoneModel="ngModel">
            <div *ngIf="phoneModel.invalid && (phoneModel.dirty || phoneModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="phoneModel.errors?.['required']">Phone is required.</span>
              <span *ngIf="phoneModel.errors?.['pattern']">Only numbers, spaces, (), - allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Email</label>
            <input type="email" class="form-control" [(ngModel)]="newDriver.email" name="email" email
              #emailModel="ngModel">
            <div *ngIf="emailModel.invalid && (emailModel.dirty || emailModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="emailModel.errors?.['email']">Invalid email format.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Drug Test Negative Date</label>
            <input type="date" class="form-control" [(ngModel)]="newDriver.drugTestNegativeDate"
              name="drugTestNegativeDate" #drugTestNegativeDateModel="ngModel">
            <!-- Optional: Add required and validation if needed -->
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Social Security #</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.ssn" name="ssn" pattern="^[0-9\-]*$"
              maxlength="9" placeholder="XXX-XX-XXXX" #ssnModel="ngModel">
            <div *ngIf="ssnModel.invalid && (ssnModel.dirty || ssnModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="ssnModel.errors?.['pattern']">Only numbers and - allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Position Applied For</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.positionAppliedFor" name="positionAppliedFor"
              pattern="^[a-zA-Z\s]*$" maxlength="50" #positionAppliedForModel="ngModel">
            <div
              *ngIf="positionAppliedForModel.invalid && (positionAppliedForModel.dirty || positionAppliedForModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="positionAppliedForModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Driver Status</label>
            <select class="form-control" [(ngModel)]="newDriver.status" name="driverStatus" required
              #driverStatusModel="ngModel">
              <option value="" disabled>Select Status</option>
              <option value="APPROVED">APPROVED</option>
              <option value="PENDING">PENDING</option>
              <option value="EXPIRING">EXPIRING</option>
            </select>
            <div
              *ngIf="driverStatusModel.invalid && (driverStatusModel.dirty || driverStatusModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="driverStatusModel.errors?.['required']">Status is required.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Pre-employment Clearing House Date</label>
            <input type="date" class="form-control" [(ngModel)]="newDriver.clearingHouseDate" name="clearingHouseDate"
              #clearingHouseDateModel="ngModel">
            <!-- Optional: Add required and validation if needed -->
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Termination Date</label>
            <input type="date" class="form-control" [(ngModel)]="newDriver.terminationDate" name="terminationDate"
              #terminationDateModel="ngModel">
            <!-- Optional: Add required and validation if needed -->
          </div>
          <div class="col-md-3">
            <label>Reason For Leaving / Termination</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.reasonForLeaving" name="reasonForLeaving"
              pattern="^[a-zA-Z\s]*$" maxlength="50" #reasonForLeavingModel="ngModel">
            <div
              *ngIf="reasonForLeavingModel.invalid && (reasonForLeavingModel.dirty || reasonForLeavingModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="reasonForLeavingModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Company</label>
            <select class="form-control" [(ngModel)]="newDriver.companyId" name="companyId" required
              #companyIdModel="ngModel">
              <option value="" disabled selected>Select Company</option>
              <option *ngFor="let company of companies" [value]="company._id">
                {{ company.companyName }}
              </option>
            </select>
            <div *ngIf="companyIdModel.invalid && (companyIdModel.dirty || companyIdModel.touched || f.submitted)"
              class="text-danger font-12">
              <span *ngIf="companyIdModel.errors?.['required']">Company is required.</span>
            </div>
          </div>
        </div>



        <div class="row mt-3 align-items-center">
          <label class="col-auto mb-0">Do you have legal right to work in the United States?</label>
          <div class="col-auto mt-2">
            <label class="me-3">
              <input type="radio" [(ngModel)]="newDriver.legalRight" name="legalRight" value="yes"> Yes
            </label>
            <label>
              <input type="radio" [(ngModel)]="newDriver.legalRight" name="legalRight" value="no"> No
            </label>
          </div>
        </div>

        <div class="row mt-2">
          <div class="col-md-3">
            <label>Work Authorization</label>
            <select class="form-control" [(ngModel)]="newDriver.workAuthorization" name="workAuthorization">
              <option value="" disabled selected>Select Work Authorization</option>
              <option value="CITIZEN">CITIZEN</option>
              <option value="PR/GREEN CARD">PR/GREEN CARD</option>
              <option value="WORK PERMIT">WORK PERMIT</option>
            </select>
          </div>
          <div class="col-md-3" *ngIf="newDriver.workAuthorization === 'WORK PERMIT'">
            <label>Work Permit USCIS No</label>
            <input type="text" class="form-control" [(ngModel)]="newDriver.workPermitUSCIS" name="workPermitUSCIS">
          </div>
          <div class="col-md-3" *ngIf="newDriver.workAuthorization === 'WORK PERMIT'">
            <label>Work Permit Expiration Date</label>
            <input type="date" class="form-control" [(ngModel)]="newDriver.workPermitExpiration"
              name="workPermitExpiration">
          </div>
        </div>



        <h4 class="mt-4 mb-3 border-bottom pb-2">PREVIOUS THREE YEARS RESIDENCY</h4>
        <table class="table table-bordered align-middle" style="background: #fff;">
          <thead class="table-light">
            <tr>
              <th style="width:18%"></th>
              <th style="width:25%">STREET</th>
              <th style="width:15%">CITY</th>
              <th style="width:12%">STATE</th>
              <th style="width:15%">ZIPCODE</th>
              <th style="width:15%">#OF YEARS AT ADDRESS</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>CURRENT ADDRESS</b></td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.currentAddressStreet"
                  name="currentAddressStreet">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.currentAddressCity"
                  name="currentAddressCity" required pattern="^[a-zA-Z\s]*$" #currentAddressCityModel="ngModel">

                <div *ngIf="currentAddressCityModel.invalid && (currentAddressCityModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="currentAddressCityModel.errors?.['required']">City is required.</span>
                  <span *ngIf="currentAddressCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
                </div>
              </td>


              <td>
                <div style="position: relative; min-width: 150px;">
                  <!-- Dropdown Button -->
                  <div class="form-control" (click)="dropdownOpen = !dropdownOpen; $event.stopPropagation()"
                    style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                    {{ getStateName(newDriver.currentAddressState) || 'Select State' }}
                  </div>

                  <!-- Dropdown List -->
                  <ul *ngIf="dropdownOpen" (click)="$event.stopPropagation()"
                    style="position: absolute; left: 0; top: 100%; width: 100%; z-index: 1000; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px; box-sizing: border-box;">
                    <li *ngFor="let state of usStates"
                      (click)="selectState(state.abbr); dropdownOpen = false; $event.stopPropagation()"
                      style="padding: 8px; cursor: pointer;" (mouseover)="hovered = state.abbr"
                      (mouseout)="hovered = null" [style.backgroundColor]="hovered === state.abbr ? '#eee' : 'white'">
                      {{ state.name }}
                    </li>
                  </ul>
                </div>
              </td>



              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.currentAddressZipcode"
                  name="currentAddressZipcode" pattern="^[0-9]*$" maxlength="9" required
                  #currentAddressZipcodeModel="ngModel">

                <div *ngIf="currentAddressZipcodeModel.invalid && (currentAddressZipcodeModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="currentAddressZipcodeModel.errors?.['required']">Zipcode is required.</span>
                  <span *ngIf="currentAddressZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>

              <td>
                <input type="text" class="form-control" name="currentAddressYears"
                  [(ngModel)]="newDriver.currentAddressYears" pattern="^[0-9]*$" #currentAddressYearsModel="ngModel"
                  required />

                <div *ngIf="currentAddressYearsModel.invalid && (currentAddressYearsModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="currentAddressYearsModel.errors?.['required']">This field is required.</span>
                  <span *ngIf="currentAddressYearsModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
            </tr>
            <tr>
              <td><b>MAILING ADDRESS</b></td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.mailingAddressStreet"
                  name="mailingAddressStreet">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.mailingAddressCity"
                  name="mailingAddressCity" required pattern="^[a-zA-Z\s]*$" #mailingAddressCityModel="ngModel">

                <div *ngIf="mailingAddressCityModel.invalid && (mailingAddressCityModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="mailingAddressCityModel.errors?.['required']">City is required.</span>
                  <span *ngIf="mailingAddressCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
                </div>
              </td>

              <td class="relative">
                <!-- Dropdown Button -->
                <div class="form-control" (click)="mailingDropdownOpen = !mailingDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(newDriver.mailingAddressState) || 'Select State' }}
                </div>

                <!-- Dropdown List -->
                <ul *ngIf="mailingDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                  <li *ngFor="let state of usStates"
                    (click)="selectMailingState(state.abbr); mailingDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="mailingHovered = state.abbr"
                    (mouseout)="mailingHovered = null"
                    [style.backgroundColor]="mailingHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>

              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.mailingAddressZipcode"
                  name="mailingAddressZipcode" pattern="^[0-9]*$" maxlength="10" required
                  #mailingAddressZipcodeModel="ngModel">

                <div *ngIf="mailingAddressZipcodeModel.invalid && (mailingAddressZipcodeModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="mailingAddressZipcodeModel.errors?.['required']">Zipcode is required.</span>
                  <span *ngIf="mailingAddressZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>

              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.mailingAddressYears"
                  name="mailingAddressYears" pattern="^[0-9]*$" #mailingAddressYearsModel="ngModel" required>

                <div *ngIf="mailingAddressYearsModel.invalid && (mailingAddressYearsModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="mailingAddressYearsModel.errors?.['required']">This field is required.</span>
                  <span *ngIf="mailingAddressYearsModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>

            </tr>
            <tr>
              <td><b>PREVIOUS ADDRESS</b></td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.previousAddressStreet"
                  name="previousAddressStreet">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.previousAddressCity"
                  name="previousAddressCity" required pattern="^[a-zA-Z\s]*$" #previousAddressCityModel="ngModel">

                <div *ngIf="previousAddressCityModel.invalid && (previousAddressCityModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="previousAddressCityModel.errors?.['required']">City is required.</span>
                  <span *ngIf="previousAddressCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
                </div>
              </td>

              <td class="relative">
                <!-- Dropdown Button -->
                <div class="form-control"
                  (click)="previousDropdownOpen = !previousDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(newDriver.previousAddressState) || 'Select State' }}
                </div>

                <!-- Dropdown List -->
                <ul *ngIf="previousDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                  <li *ngFor="let state of usStates"
                    (click)="selectPreviousState(state.abbr); previousDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="previousHovered = state.abbr"
                    (mouseout)="previousHovered = null"
                    [style.backgroundColor]="previousHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.previousAddressZipcode"
                  name="previousAddressZipcode" pattern="^[0-9]*$" maxlength="10" required
                  #previousAddressZipcodeModel="ngModel">
                <div *ngIf="previousAddressZipcodeModel.invalid && (previousAddressZipcodeModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="previousAddressZipcodeModel.errors?.['required']">Zipcode is required.</span>
                  <span *ngIf="previousAddressZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>

              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.previousAddressYears"
                  name="previousAddressYears" pattern="^[0-9]*$" required #previousAddressYearsModel="ngModel">
                <div *ngIf="previousAddressYearsModel.invalid && (previousAddressYearsModel.touched || f.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="previousAddressYearsModel.errors?.['required']">Years at address is required.</span>
                  <span *ngIf="previousAddressYearsModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>

            </tr>
          </tbody>
        </table>

        <!-- LICENSE INFORMATION TABLE (matches your screenshot) -->
        <h4 class="mt-4 mb-3 border-bottom pb-2">LICENSE INFORMATION</h4>
        <table class="table table-bordered align-middle" style="background: #fff;">
          <thead class="table-light">
            <tr>
              <th style="width:18%"></th>
              <th style="width:15%">STATE</th>
              <th style="width:18%">LICENSE NO</th>
              <th style="width:15%">TYPE/CLASS</th>
              <th style="width:15%">ENDORSEMENTS</th>
              <th style="width:14%">ISSUE DATE</th>
              <th style="width:15%">EXPIRATION DATE</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>CURRENT CDL</b></td>
              <td style="position: relative; min-width: 150px;">
                <!-- Dropdown Button -->
                <div class="form-control"
                  (click)="currentCdlDropdownOpen = !currentCdlDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(newDriver.currentCdlState) || 'Select State' }}
                </div>

                <!-- Dropdown List -->
                <ul *ngIf="currentCdlDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; left: 0; right: 0; top: 100%; width: 100%; z-index: 1000; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px; box-sizing: border-box;">
                  <li *ngFor="let state of usStates"
                    (click)="selectCurrentCdlState(state.abbr); currentCdlDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="currentCdlHovered = state.abbr"
                    (mouseout)="currentCdlHovered = null"
                    [style.backgroundColor]="currentCdlHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>

              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.currentCdlNumber" name="currentCdlNumber"
                  pattern="^[a-zA-Z0-9]*$">
                <div *ngIf="f.submitted && f.controls['currentCdlNumber']?.errors" class="text-danger font-12">
                  <span *ngIf="f.controls['currentCdlNumber']?.errors?.['pattern']">Only letters and numbers
                    allowed.</span>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.currentCdlType" name="currentCdlType"
                  pattern="^[a-zA-Z\s]*$">
                <div *ngIf="f.submitted && f.controls['currentCdlType']?.errors" class="text-danger font-12">
                  <span *ngIf="f.controls['currentCdlType']?.errors?.['pattern']">Only letters allowed.</span>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.currentCdlEndorsements"
                  name="currentCdlEndorsements">
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="newDriver.currentCdlIssueDate"
                    name="currentCdlIssueDate">
                </div>
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="newDriver.currentCdlExpirationDate"
                    name="currentCdlExpirationDate">
                </div>
              </td>
            </tr>
            <tr>
              <td><b>OLD CDL</b></td>
              <td class="relative">
                <!-- Dropdown Button -->
                <div class="form-control" (click)="oldCdlDropdownOpen = !oldCdlDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(newDriver.oldCdlState) || 'Select State' }}
                </div>




                <!-- Dropdown List -->
                <ul *ngIf="oldCdlDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                  <li *ngFor="let state of usStates"
                    (click)="selectOldCdlState(state.abbr); oldCdlDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="oldCdlHovered = state.abbr"
                    (mouseout)="oldCdlHovered = null"
                    [style.backgroundColor]="oldCdlHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.oldCdlNumber" name="oldCdlNumber"
                  pattern="^[a-zA-Z0-9]*$">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.oldCdlType" name="oldCdlType"
                  pattern="^[a-zA-Z\s]*$">
                <div *ngIf="f.submitted && f.controls['oldCdlType']?.errors" class="text-danger font-12">
                  <span *ngIf="f.controls['oldCdlType']?.errors?.['pattern']">Only letters allowed.</span>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="newDriver.oldCdlEndorsements"
                  name="oldCdlEndorsements">
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="newDriver.oldCdlIssueDate"
                    name="oldCdlIssueDate">
                </div>
              </td>
              <td>
                <div style="position: relative;">

                  <input type="date" class="form-control" [(ngModel)]="newDriver.oldCdlExpirationDate"
                    name="oldCdlExpirationDate">
                </div>
              </td>
            </tr>
          </tbody>
        </table>


        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            data-bs-dismiss="offcanvas" aria-label="Close" (click)="onClose()"> Close</button>
          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill">save</button>

          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
            (click)="goToSection('driving-info', $event)" [disabled]="!f.valid">Next</button>
        </div>
      </div>


      <!-- Driving Experience Section -->
      <div class="content_ac" *ngIf="activeSection === 'driving-info'">
        <h3 class="mb-4">Driving Experience</h3>

        <!-- DRIVING EXPERIENCE TABLE -->
        <div class="col-12">
          <h5 class="mb-2">Driving Experience</h5>
          <table class="table table-bordered align-middle" style="background: #fff;">
            <thead class="table-light">
              <tr>
                <th>CLASS OF EQUIPMENT</th>
                <th>TYPE OF EQUIPMENT (VAN, TANK, FLAT, ETC.)</th>
                <th>DATE FROM</th>
                <th>DATE TO</th>
                <th>APPROX # OF MILES (TOTAL)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let exp of newDriver.drivingExperiences; let i = index">
                <td>
                  <select class="form-control" [(ngModel)]="exp.classOfEquipment" name="classOfEquipment{{i}}" required>
                    <option value="">-- Select Class --</option>
                    <option value="straight truck">Straight Truck</option>
                    <option value="tractor & semi-trailer">Tractor & Semi-Trailer</option>
                    <option value="tractor & tanker">Tractor & Tanker</option>
                    <option value="other">Other</option>
                  </select>

                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="exp.typeOfEquipment" name="typeOfEquipment{{i}}"
                    required>
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="exp.dateFrom" name="dateFrom{{i}}" required>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="exp.dateTo" name="dateTo{{i}}" required>
                  </div>
                </td>
                <td>
                  <input type="number" class="form-control" [(ngModel)]="exp.approxMiles" name="approxMiles{{i}}"
                    required min="0">
                  <div *ngIf="f.submitted && f.controls['approxMiles'+i]?.errors" class="text-danger font-12">
                    <span *ngIf="f.controls['approxMiles'+i]?.errors?.['min']">Must be positive.</span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="btn btn-sm btn-outline-success mt-2"
            (click)="newDriver.drivingExperiences.push({})">
            <i class="fa fa-plus"></i> Add Row
          </button>
        </div>

        <!-- ACCIDENT RECORD FOR THE PAST 3 YEARS -->
        <div class="col-12 mt-4">
          <h5 class="mb-2">Accident Record for the Past 3 Years</h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" [(ngModel)]="newDriver.noAccidents" name="noAccidents"
              id="noAccidents">
            <label class="form-check-label" for="noAccidents">
              Check this box if you are not involved in any accident (Previous)
            </label>
          </div>
          <table class="table table-bordered align-middle" style="background: #fff;">
            <thead class="table-light">
              <tr>
                <th>DATE</th>
                <th>NATURE OF ACCIDENT (Head-on, rear-end, upset, etc.)</th>
                <th>FATALITIES</th>
                <th>INJURIES</th>
                <th>Remark (Driver Fault, Other Party Fault)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let acc of newDriver.accidentRecords; let i = index">
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="acc.date" name="accidentDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="acc.nature" name="accidentNature{{i}}">
                </td>
                <td>
                  <input type="number" class="form-control" [(ngModel)]="acc.fatalities" name="accidentFatalities{{i}}"
                    min="0">
                </td>
                <td>
                  <input type="number" class="form-control" [(ngModel)]="acc.injuries" name="accidentInjuries{{i}}"
                    min="0">
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="acc.remark" name="accidentRemark{{i}}">
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class=" mt-2 btn btn-sm btn-outline-success"
            (click)="newDriver.accidentRecords.push({})">
            <i class="fa fa-plus"></i> Add Row
          </button>
        </div>

        <!-- TRAFFIC CONVICTIONS AND FORFEITURES FOR THE PAST 3 YEARS -->
        <div class="col-12 mt-4">
          <h5 class="mb-2">Traffic Convictions and Forfeitures for the Past 3 Years (Other than Parking Violations)
          </h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" [(ngModel)]="newDriver.noCitations" name="noCitations"
              id="noCitations">
            <label class="form-check-label" for="noCitations">
              Check this box if you are not charged for any citation
            </label>
          </div>
          <table class="table table-bordered align-middle" style="background: #fff;">
            <thead class="table-light">
              <tr>
                <th>STATE OF VIOLATION</th>
                <th>VIOLATION TYPE</th>
                <th>Ticket Date</th>
                <th>Conviction Date</th>
                <th>Remark (Guilty, Reduce to Zero)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let vio of newDriver.trafficViolations; let i = index">
                <td>
                  <select class="form-control" [(ngModel)]="vio.stateOfViolation" name="stateOfViolation{{i}}" required>
                    <option value="">-- Select State --</option>
                    <option value="Test 1">Test 1</option>
                    <option value="Test 2">Test 2</option>
                    <option value="Test 3">Test 3</option>
                    <option value="other">Other</option>
                  </select>
                </td>

                <td>
                  <input type="text" class="form-control" [(ngModel)]="vio.type" name="violationType{{i}}">
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="vio.ticketDate"
                      name="violationTicketDate{{i}}">
                  </div>
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="vio.convictionDate"
                      name="violationConvictionDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="vio.remark" name="violationRemark{{i}}">
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class=" mt-2 btn btn-sm btn-outline-success"
            (click)="newDriver.trafficViolations.push({})">
            <i class="fa fa-plus"></i> Add Row
          </button>
        </div>

        <!-- LICENSE DENIAL/REVOCATION QUESTIONS -->
        <div class="col-12 mt-4">
          <div class="row">
            <div class="col-12 mb-3">
              <div class="d-flex align-items-center">
                <label class="font-weight-600 me-3 mb-0">
                  Have you ever been denied a license, permit, or privilege to operate a motor vehicle?
                </label>
                <div style="display: flex; gap: 20px;">
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="newDriver.licenseDenied" name="licenseDenied" value="YES"> YES
                  </label>
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="newDriver.licenseDenied" name="licenseDenied" value="NO"> NO
                  </label>
                </div>
              </div>

              <div *ngIf="newDriver.licenseDenied === 'YES'" class="mt-2">
                <textarea class="form-control" [(ngModel)]="newDriver.licenseDeniedExplain" name="licenseDeniedExplain"
                  placeholder="If Yes, Please explain" rows="3"></textarea>
              </div>

            </div>
            <div class="col-12 mb-3">
              <div class="d-flex align-items-center">
                <label class="font-weight-600 me-3 mb-0">
                  Has any license, permit, or privilege ever been suspended or revoked?
                </label>
                <div style="display: flex; gap: 20px;">
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="newDriver.licenseSuspended" name="licenseSuspended" value="YES">
                    YES
                  </label>
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="newDriver.licenseSuspended" name="licenseSuspended" value="NO">
                    NO
                  </label>
                </div>
              </div>
              <div *ngIf="newDriver.licenseSuspended === 'YES'" class="mt-2">
                <textarea class="form-control" [(ngModel)]="newDriver.licenseSuspendedExplain"
                  name="licenseSuspendedExplain" placeholder="If Yes, Please explain" rows="3"></textarea>
              </div>
            </div>
          </div>
        </div>
        <!-- FORM BUTTONS -->
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            data-bs-dismiss="offcanvas" aria-label="Close" (click)="onClose()"> Close</button>
          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill">save</button>

          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
            (click)="goToSection('employment-history', $event)" [disabled]="!f.valid">Next</button>
        </div>
      </div>


      <!-- Employment History Section -->
      <div class="content_ac" *ngIf="activeSection === 'employment-history'">
        <h3 class="mb-4">Employment History</h3>

        <div *ngFor="let emp of newDriver.employmentHistory; let i = index" class="border rounded p-3 mb-4 bg-white">
          <h5 class="mb-3">{{ i === 0 ? 'CURRENT (MOST RECENT) EMPLOYER' : (i === 1 ? 'SECOND (MOST RECENT) EMPLOYER'
            : 'PREVIOUS EMPLOYER ' + (i+1)) }}</h5>
          <div class="row">
            <div class="col-md-4">
              <label>Company Name</label>
              <input type="text" class="form-control" [(ngModel)]="emp.companyName" name="companyName{{i}}" required
                pattern="^[a-zA-Z ]*$" #companyNameModel="ngModel">
              <div
                *ngIf="companyNameModel.invalid && (companyNameModel.dirty || companyNameModel.touched || f.submitted)"
                class="text-danger font-12">
                <span *ngIf="companyNameModel.errors?.['required']">Company Name is required.</span>
                <span *ngIf="companyNameModel.errors?.['pattern']">Only letters allowed.</span>
              </div>
            </div>

            <div class="col-md-4">
              <label>Contact No</label>
              <input type="text" class="form-control" [(ngModel)]="emp.contactNo" name="contactNo{{i}}"
                pattern="^[0-9\-()\s]+$" maxlength="10" #contactNoModel="ngModel">
              <div *ngIf="contactNoModel.invalid && (contactNoModel.dirty || contactNoModel.touched || f.submitted)"
                class="text-danger font-12">
                <span *ngIf="contactNoModel.errors?.['pattern']">Only numbers allowed.</span>
              </div>
            </div>
            <div class="col-md-4">
              <label>Email</label>
              <input type="email" class="form-control" [(ngModel)]="emp.email" name="email{{i}}" email
                #emailEmpModel="ngModel">
              <div *ngIf="emailEmpModel.invalid && (emailEmpModel.dirty || emailEmpModel.touched || f.submitted)"
                class="text-danger font-12">
                <span *ngIf="emailEmpModel.errors?.['email']">Invalid email format.</span>
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-4">
              <label>Company Address (Street)</label>
              <input type="text" class="form-control" [(ngModel)]="emp.street" name="street{{i}}"
                #streetModel="ngModel">
              <!-- Add validation if needed -->
            </div>
            <div class="col-md-3">
              <label>City</label>
              <input type="text" class="form-control" [(ngModel)]="emp.city" name="city{{i}}" required
                pattern="^[a-zA-Z\s]*$" #cityModel="ngModel">
              <div *ngIf="cityModel.invalid && (cityModel.touched || f.submitted)" class="text-danger font-12 mt-1">
                <span *ngIf="cityModel.errors?.['required']">City is required.</span>
                <span *ngIf="cityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
              </div>
            </div>

            <div class="col-md-3 relative">
              <label>State</label>
              <!-- Dropdown Button -->
              <div class="form-control no-wrap" (click)="emp.dropdownOpen = !emp.dropdownOpen; $event.stopPropagation()"
                style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                {{ getStateName(emp.state) || 'Select State' }}
              </div>
              <!-- Dropdown List -->
              <ul *ngIf="emp.dropdownOpen" (click)="$event.stopPropagation()"
                style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                <li *ngFor="let state of usStates"
                  (click)="emp.state = state.abbr; emp.dropdownOpen = false; $event.stopPropagation()"
                  style="padding: 8px; cursor: pointer;" (mouseover)="emp.hovered = state.abbr"
                  (mouseout)="emp.hovered = null"
                  [style.backgroundColor]="emp.hovered === state.abbr ? '#eee' : 'white'">
                  {{ state.name }}
                </li>
              </ul>
            </div>



            <div class="col-md-2">
              <label>Zipcode</label>
              <input type="text" class="form-control" [(ngModel)]="emp.zipcode" name="zipcode{{i}}" pattern="^[0-9]*$"
                maxlength="10" #zipcodeModel="ngModel">
              <div *ngIf="zipcodeModel.invalid && (zipcodeModel.dirty || zipcodeModel.touched || f.submitted)"
                class="text-danger font-12">
                <span *ngIf="zipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-4">
              <label>Position Held</label>
              <select class="form-control" [(ngModel)]="emp.positionHeld" name="positionHeld{{i}}"
                #positionHeldModel="ngModel" required>
                <option value="">-- Select Position --</option>
                <option value="Test 1">Test 1</option>
                <option value="Test 2">Test 2</option>
                <option value="Test 3">Test 3</option>
                <option value="other">Other</option>
              </select>
            </div>

            <div class="col-md-4">
              <label>Start Date</label>
              <input type="date" class="form-control" [(ngModel)]="emp.startDate" name="startDate{{i}}"
                #startDateModel="ngModel">
              <!-- Add validation if needed -->
            </div>
            <div class="col-md-4">
              <label>End Date</label>
              <input type="date" class="form-control" [(ngModel)]="emp.endDate" name="endDate{{i}}"
                #endDateModel="ngModel">
              <!-- Add validation if needed -->
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-6">
              <label>Reason For Leaving</label>
              <input type="text" class="form-control" [(ngModel)]="emp.reasonForLeaving" name="reasonForLeaving{{i}}"
                #reasonForLeavingEmpModel="ngModel">
              <!-- Add validation if needed -->
            </div>
            <div class="col-md-6">
              <label>EXPLAIN ANY GAPS IN NEXT EMPLOYMENT (Include month/year & reason)</label>
              <input type="text" class="form-control" [(ngModel)]="emp.gapsExplanation" name="gapsExplanation{{i}}"
                #gapsExplanationModel="ngModel">
              <!-- Add validation if needed -->
            </div>
          </div>
          <div class="row mt-2">
            <!-- First Question -->
            <div class="col-md-12 d-flex align-items-center">
              <label class="me-3">
                While employed here, were you subject to the Federal Motor Carrier Safety Regulations?
              </label>
              <label class="me-3 mb-0">
                <input type="radio" [(ngModel)]="emp.fmcsaSubject" name="fmcsaSubject{{i}}" value="YES"> YES
              </label>
              <label class="mb-0">
                <input type="radio" [(ngModel)]="emp.fmcsaSubject" name="fmcsaSubject{{i}}" value="NO"> NO
              </label>
            </div>

            <!-- Second Question -->
            <div class="col-md-12 d-flex align-items-center mt-2">
              <label class="me-3">
                Was the job designated as a safety-sensitive function in any DOT-regulated mode under 49 CFR part 40?
              </label>
              <label class="me-3 mb-0">
                <input type="radio" [(ngModel)]="emp.dotSensitive" name="dotSensitive{{i}}" value="YES"> YES
              </label>
              <label class="mb-0">
                <input type="radio" [(ngModel)]="emp.dotSensitive" name="dotSensitive{{i}}" value="NO"> NO
              </label>
            </div>
          </div>


          <div class="text-end mt-2" *ngIf="newDriver.employmentHistory.length > 1">
            <button type="button" class="btn btn-danger btn-sm" (click)="removeEmploymentHistory(i)">
              <i class="fa fa-trash"></i> Remove
            </button>
          </div>

        </div>
        <div class="mt-1">
          <button type="button" class="btn btn-outline-success btn-sm" (click)="addEmploymentHistory()">
            <i class="fa fa-plus"></i> Add Previous Employer
          </button>
        </div>
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            data-bs-dismiss="offcanvas" aria-label="Close" (click)="onClose()"> Close</button>
          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill">save</button>

          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
            (click)="goToSection('document-info', $event)" [disabled]="!f.valid">Next</button>

        </div>

      </div>



      <!-- Document Information Section -->
      <div class="content_ac" *ngIf="activeSection === 'document-info'">
        <h3 class="mb-4">Document Information</h3>

        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Number</th>
                <th>Date / Expiry</th>
                <th>Upload Document</th>
              </tr>
            </thead>
            <tbody>
              <!-- CDL -->
              <tr>
                <td>CDL</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.cdlNumber" name="cdlNumber"
                    pattern="^[a-zA-Z0-9 ]*$" #cdlNumberModel="ngModel">
                  <div *ngIf="cdlNumberModel.invalid && (cdlNumberModel.dirty || cdlNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="cdlNumberModel.errors?.['pattern']">Only letters and numbers allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.cdlExpiry" name="cdlExpiry"
                      #cdlExpiryModel="ngModel">
                    <!-- Add validation if needed -->
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'cdlFile')">
                  <small *ngIf="getFileName('cdlFile')">{{ getFileName('cdlFile') }}</small>
                </td>
              </tr>
              <!-- Commercial Medical Certificate -->
              <tr>
                <td>Driver Commercial Medical Certificate</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.medicalCertificateNumber"
                    name="medicalCertificateNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #medicalCertificateNumberModel="ngModel">
                  <div
                    *ngIf="medicalCertificateNumberModel.invalid && (medicalCertificateNumberModel.dirty || medicalCertificateNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="medicalCertificateNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.medicalCertificateExpiry"
                      name="medicalCertificateExpiry" #medicalCertificateExpiryModel="ngModel">
                    <!-- Add validation if needed -->
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'medicalCertificateFile')">
                  <small *ngIf="getFileName('medicalCertificateFile')">{{ getFileName('medicalCertificateFile')
                    }}</small>
                </td>
              </tr>
              <!-- MVR Driving Record -->
              <tr>
                <td>DMV Driving Record</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.mvrNumber" name="mvrNumber"
                    pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #mvrNumberModel="ngModel">
                  <div *ngIf="mvrNumberModel.invalid && (mvrNumberModel.dirty || mvrNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="mvrNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.mvrPullDate" name="mvrPullDate"
                      #mvrPullDateModel="ngModel">
                    <!-- Add validation if needed -->
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'mvrFile')">
                  <small *ngIf="getFileName('mvrFile')">{{ getFileName('mvrFile') }}</small>
                </td>
              </tr>
              <!-- BACKGROUND CHECK DOCUMENT -->
              <tr>
                <td>Background Check Document</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.backgroundCheckNumber"
                    name="backgroundCheckNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #backgroundCheckNumberModel="ngModel">
                  <div
                    *ngIf="backgroundCheckNumberModel.invalid && (backgroundCheckNumberModel.dirty || backgroundCheckNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="backgroundCheckNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.backgroundCheckDate"
                      name="backgroundCheckDate" #backgroundCheckDateModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'backgroundCheckFile')">
                  <small *ngIf="getFileName('backgroundCheckFile')">{{ getFileName('backgroundCheckFile') }}</small>
                </td>
              </tr>
              <!-- PSP RECORD -->
              <tr>
                <td>PSP Record</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.pspNumber" name="pspNumber"
                    pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #pspNumberModel="ngModel">
                  <div *ngIf="pspNumberModel.invalid && (pspNumberModel.dirty || pspNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="pspNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.pspPullDate" name="pspPullDate"
                      #pspPullDateModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'pspFile')">
                  <small *ngIf="getFileName('pspFile')">{{ getFileName('pspFile') }}</small>
                </td>
              </tr>
              <!-- Work Authorization -->
              <tr>
                <td>Work Authorization Document</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.workAuthNumber" name="workAuthNumber"
                    pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #workAuthNumberModel="ngModel">
                  <div
                    *ngIf="workAuthNumberModel.invalid && (workAuthNumberModel.dirty || workAuthNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="workAuthNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.workAuthExpiry" name="workAuthExpiry"
                      #workAuthExpiryModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'workAuthFile')">
                  <small *ngIf="getFileName('workAuthFile')">{{ getFileName('workAuthFile') }}</small>
                </td>
              </tr>
              <!-- SSN Card -->

              <tr>
                <td>SSN Card</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.ssnNumber" name="ssnNumber"
                    pattern="^[0-9\-]*$" maxlength="9" placeholder="XXX-XX-XXXX" #ssnNumberModel="ngModel">
                  <div *ngIf="ssnNumberModel.invalid && (ssnNumberModel.dirty || ssnNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="ssnNumberModel.errors?.['pattern']">Only numbers and - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.pspPullDate" name="pspPullDate"
                      #ssnCardDateModel="ngModel">
                    <!-- Add validation if needed -->
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'ssnFile')">
                  <small *ngIf="getFileName('ssnFile')">{{ getFileName('ssnFile') }}</small>
                </td>
              </tr>
              <!-- Pre-employment Clearing House -->
              <tr>
                <td>Pre-employment Clearing House</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.preClearingHouseNumber"
                    name="preClearingHouseNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #preClearingHouseNumberModel="ngModel">
                  <div
                    *ngIf="preClearingHouseNumberModel.invalid && (preClearingHouseNumberModel.dirty || preClearingHouseNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="preClearingHouseNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.preClearingHouseExpiry"
                      name="preClearingHouseExpiry" #preClearingHouseExpiryModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'preClearingHouseFile')">
                  <small *ngIf="getFileName('preClearingHouseFile')">{{ getFileName('preClearingHouseFile') }}</small>
                </td>
              </tr>
              <!-- Pre-employment Drug Test CCF -->
              <tr>
                <td>Pre-employment Drug Test CCF</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.preDrugTestCCFNumber"
                    name="preDrugTestCCFNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #preDrugTestCCFNumberModel="ngModel">
                  <div
                    *ngIf="preDrugTestCCFNumberModel.invalid && (preDrugTestCCFNumberModel.dirty || preDrugTestCCFNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="preDrugTestCCFNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.preDrugTestCCFDate"
                      name="preDrugTestCCFDate" #preDrugTestCCFDateModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'preDrugTestCCFFile')">
                  <small *ngIf="getFileName('preDrugTestCCFFile')">{{ getFileName('preDrugTestCCFFile') }}</small>
                </td>
              </tr>
              <!-- Pre-employment Drug Test Result -->
              <tr>
                <td>Pre-employment Drug Test Result</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.preDrugTestResultNumber"
                    name="preDrugTestResultNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #preDrugTestResultNumberModel="ngModel">
                  <div
                    *ngIf="preDrugTestResultNumberModel.invalid && (preDrugTestResultNumberModel.dirty || preDrugTestResultNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="preDrugTestResultNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.preDrugTestResultDate"
                      name="preDrugTestResultDate" #preDrugTestResultDateModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'preDrugTestResultFile')">
                  <small *ngIf="getFileName('preDrugTestResultFile')">{{ getFileName('preDrugTestResultFile') }}</small>
                </td>
              </tr>
              <!-- ANNUAL CLEARING HOUSE -->
              <tr>
                <td>Annual Clearing House</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.annualClearingHouseNumber"
                    name="annualClearingHouseNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #annualClearingHouseNumberModel="ngModel">
                  <div
                    *ngIf="annualClearingHouseNumberModel.invalid && (annualClearingHouseNumberModel.dirty || annualClearingHouseNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="annualClearingHouseNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.annualClearingHouseExpiry"
                      name="annualClearingHouseExpiry" #annualClearingHouseExpiryModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'annualClearingHouseFile')">
                  <small *ngIf="getFileName('annualClearingHouseFile')">{{ getFileName('annualClearingHouseFile')
                    }}</small>
                </td>
              </tr>
              <!-- PULL NOTICE -->
              <tr>
                <td>Pull Notice</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.pullNoticeNumber"
                    name="pullNoticeNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #pullNoticeNumberModel="ngModel">
                  <div
                    *ngIf="pullNoticeNumberModel.invalid && (pullNoticeNumberModel.dirty || pullNoticeNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="pullNoticeNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.pullNoticeExpiry"
                      name="pullNoticeExpiry" #pullNoticeExpiryModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'pullNoticeFile')">
                  <small *ngIf="getFileName('pullNoticeFile')">{{ getFileName('pullNoticeFile') }}</small>
                </td>
              </tr>
              <!-- FMCSA National Registry -->
              <tr>
                <td>FMCSA National Registry</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.nationalRegistryNumber"
                    name="nationalRegistryNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #nationalRegistryNumberModel="ngModel">
                  <div
                    *ngIf="nationalRegistryNumberModel.invalid && (nationalRegistryNumberModel.dirty || nationalRegistryNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="nationalRegistryNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.nationalRegistryExpiry"
                      name="nationalRegistryExpiry" #nationalRegistryExpiryModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'nationalRegistryFile')">
                  <small *ngIf="getFileName('nationalRegistryFile')">{{ getFileName('nationalRegistryFile') }}</small>
                </td>
              </tr>
              <!-- Driver Road Test -->
              <tr>
                <td>Driver Road Test / Driver Proficiency & Vehicle Authorization Docs</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="newDriver.roadTestNumber" name="roadTestNumber"
                    pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #roadTestNumberModel="ngModel">
                  <div
                    *ngIf="roadTestNumberModel.invalid && (roadTestNumberModel.dirty || roadTestNumberModel.touched || f.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="roadTestNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="newDriver.roadTestDate" name="roadTestDate"
                      #roadTestDateModel="ngModel">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'roadTestFile')">
                  <small *ngIf="getFileName('roadTestFile')">{{ getFileName('roadTestFile') }}</small>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <hr>

        <!-- RANDOM DRUG TEST CCF (multiple allowed) -->
        <h3 class="mb-4">RANDOM DRUG TEST CCF</h3>
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Number</th>
                <th>Date</th>
                <th>Upload Document</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let randomCCF of newDriver.randomDrugTestCCFs; let i = index">
                <td>RANDOM DRUG TEST CCF</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="randomCCF.number"
                    name="randomDrugTestCCFNumber{{i}}">
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="randomCCF.date"
                      name="randomDrugTestCCFDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'randomDrugTestCCFFile' + i)">
                  <small *ngIf="getFileName('randomDrugTestCCFFile' + i)">
                    {{ getFileName('randomDrugTestCCFFile' + i) }}
                  </small>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-success btn-sm" (click)="addRandomDrugTestCCF()">
               
              <i class="fa fa-plus"></i> Add Random Drug Test CCF
            </button>

            <button *ngIf="newDriver.randomDrugTestCCFs.length > 0" type="button" class="btn btn-danger btn-sm"
              (click)="removeRandomDrugTestCCF(newDriver.randomDrugTestCCFs.length - 1)"
              [disabled]="newDriver.randomDrugTestCCFs.length === 1">
              Remove Last
            </button>
          </div>
        </div>
        <!-- RANDOM DRUG TEST RESULT Section -->
        <hr>
        <h3 class="mb-4">RANDOM DRUG TEST RESULT</h3>
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Number</th>
                <th>Date</th>
                <th>Upload Document</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let randomResult of newDriver.randomDrugTestResults; let i = index">
                <td>
                  RANDOM DRUG TEST RESULT
                  <!-- Delete icon removed -->
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="randomResult.number"
                    name="randomDrugTestResultNumber{{i}}">
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="randomResult.date"
                      name="randomDrugTestResultDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control"
                    (change)="onFileChange($event, 'randomDrugTestResultFile' + i)">
                  <small *ngIf="getFileName('randomDrugTestResultFile' + i)">
                    {{ getFileName('randomDrugTestResultFile' + i) }}
                  </small>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-success btn-sm" (click)="addRandomDrugTestResult()">
              <i class="fa fa-plus"></i> Add Random Drug Test Result
            </button>
            <button *ngIf="newDriver.randomDrugTestResults.length > 0" type="button" class="btn btn-danger btn-sm"
              (click)="removeRandomDrugTestResult(newDriver.randomDrugTestResults.length - 1)"
              [disabled]="newDriver.randomDrugTestResults.length === 1">
              >
              Remove Last
            </button>
          </div>
        </div>

        <hr>
        <h3 class="mb-4">Miscellaneous Document</h3>
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Name</th>
                <th>Date</th>
                <th>Upload Document</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let misc of newDriver.miscDocuments; let i = index">
                <td>
                  Miscellaneous Document
                  <!-- Delete icon removed -->
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="misc.name" name="miscDocumentName{{i}}"
                    placeholder="Document Name">
                </td>
                <td>
                  <div style="position: relative;">

                    <input type="date" class="form-control" [(ngModel)]="misc.date" name="miscDocumentDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="onFileChange($event, 'miscDocumentFile' + i)">
                  <small *ngIf="getFileName('miscDocumentFile' + i)">
                    {{ getFileName('miscDocumentFile' + i) }}
                  </small>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-success btn-sm" (click)="addMiscDocument()">
              <i class="fa fa-plus"></i> Add Miscellaneous Document
            </button>
            <button *ngIf="newDriver.miscDocuments.length > 0" type="button" class="btn btn-danger btn-sm"
              (click)="removeMiscDocument(newDriver.miscDocuments.length - 1)"
              [disabled]="newDriver.miscDocuments.length === 1">
              Remove Last
            </button>
          </div>
        </div>
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="submit" class="btn btn-success btn-sm text-uppercase rounded-pill" data-bs-dismiss="offcanvas"
            [disabled]="!f.valid">Submit</button>
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            data-bs-dismiss="offcanvas" aria-label="Close" (click)="onClose()"> Close</button>

        </div>
      </div>
    </form>
  </div>
</div>

<!-- Edit Form -->


<!-- Edit Driver Offcanvas/Modal (Full Multi-Section Design) -->
<div class="offcanvas offcanvas-end" id="editDriverModal" aria-labelledby="editDriverModalLabel" style="width: 80%;"
  data-bs-backdrop="static">
  <div class="modal-header" style="padding: 15px; border-bottom: 1px solid #ccc;">
    <h5 class="modal-title">Edit Driver</h5>
    <div>
      <button type="button" class="btn-close" (click)="closeEditModal()" aria-label="Close"></button>
    </div>
  </div>
  <div class="offcanvas-body view-load position-relative">
    <form class="row g-3" (ngSubmit)="updateDriver()" #editForm="ngForm" #editF="ngForm">

      <!-- Sidebar Navigation for Sections -->
      <div class="sidebar_ac">
        <h3 class="text-black text-center " style="margin-right: 85px;"   >Edit Form</h3>
        <ul style="margin-left: 15px;">
          <li [ngClass]="{'active-option': activeSection === 'personal-info'}">
            <a href="#" class="toggle-section"
              (click)="activeSection = 'personal-info'; $event.preventDefault();">Driver Information</a>
          </li>
          <li [ngClass]="{'active-option': activeSection === 'driving-info'}">
            <a href="#" class="toggle-section"
              (click)="activeSection = 'driving-info'; $event.preventDefault();">Driving Experience</a>
          </li>
          <li [ngClass]="{'active-option': activeSection === 'employment-history'}">
            <a href="#" class="toggle-section"
              (click)="activeSection = 'employment-history'; $event.preventDefault();">Employment History</a>
          </li>
          <li [ngClass]="{'active-option': activeSection === 'document-info'}">
            <a href="#" class="toggle-section"
              (click)="activeSection = 'document-info'; $event.preventDefault();">Document Information</a>
          </li>
        </ul>
      </div>

      <!-- Personal Information Section -->
      <div class="content_ac" *ngIf="activeSection === 'personal-info'">
        <h4 class="mt-4 mb-3 border-bottom pb-2">APPLICANT INFORMATION</h4>
        <div class="row">
          <div class="col-md-3">
            <label>Driver First Name</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.firstName" name="editFirstName" required
              pattern="^[a-zA-Z\s]*$" maxlength="30" #editFirstNameModel="ngModel">
            <div
              *ngIf="editFirstNameModel.invalid && (editFirstNameModel.dirty || editFirstNameModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editFirstNameModel.errors?.['required']">First Name is required.</span>
              <span *ngIf="editFirstNameModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Driver Middle Name</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.middleName" name="editMiddleName"
              pattern="^[a-zA-Z\s]*$" maxlength="30" #editMiddleNameModel="ngModel">
            <div
              *ngIf="editMiddleNameModel.invalid && (editMiddleNameModel.dirty || editMiddleNameModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editMiddleNameModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Driver Last Name</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.lastName" name="editLastName" required
              pattern="^[a-zA-Z\s]*$" maxlength="30" #editLastNameModel="ngModel">
            <div
              *ngIf="editLastNameModel.invalid && (editLastNameModel.dirty || editLastNameModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editLastNameModel.errors?.['required']">Last Name is required.</span>
              <span *ngIf="editLastNameModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Active Date</label>
            <input type="date" class="form-control" [(ngModel)]="driverToEdit.activeDate" name="editActiveDate"
              #editActiveDateModel="ngModel">
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Date of Birth (DOB)</label>
            <input type="date" class="form-control" [(ngModel)]="driverToEdit.dob" name="editDob" required
              #editDobModel="ngModel">
            <div *ngIf="editDobModel.invalid && (editDobModel.dirty || editDobModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editDobModel.errors?.['required']">DOB is required.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Phone</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.phone" name="editPhone" required
              pattern="^[0-9\-()\s]+$" maxlength="10" placeholder="(XXX) XXX-XXXX" #editPhoneModel="ngModel">
            <div
              *ngIf="editPhoneModel.invalid && (editPhoneModel.dirty || editPhoneModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editPhoneModel.errors?.['required']">Phone is required.</span>
              <span *ngIf="editPhoneModel.errors?.['pattern']">Only numbers, spaces, (), - allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Email</label>
            <input type="email" class="form-control" [(ngModel)]="driverToEdit.email" name="editEmail" email
              #editEmailModel="ngModel">
            <div
              *ngIf="editEmailModel.invalid && (editEmailModel.dirty || editEmailModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editEmailModel.errors?.['email']">Invalid email format.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Drug Test Negative Date</label>
            <input type="date" class="form-control" [(ngModel)]="driverToEdit.drugTestNegativeDate"
              name="editDrugTestNegativeDate" #editDrugTestNegativeDateModel="ngModel">
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Social Security #</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.ssn" name="editSsn" pattern="^[0-9\-]*$"
              maxlength="11" placeholder="XXX-XX-XXXX" #editSsnModel="ngModel">
            <div *ngIf="editSsnModel.invalid && (editSsnModel.dirty || editSsnModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editSsnModel.errors?.['pattern']">Only numbers and - allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Position Applied For</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.positionAppliedFor"
              name="editPositionAppliedFor" pattern="^[a-zA-Z\s]*$" maxlength="50"
              #editPositionAppliedForModel="ngModel">
            <div
              *ngIf="editPositionAppliedForModel.invalid && (editPositionAppliedForModel.dirty || editPositionAppliedForModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editPositionAppliedForModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Driver Status</label>
            <select class="form-control" [(ngModel)]="driverToEdit.status" name="editDriverStatus" required
              #editDriverStatusModel="ngModel">
              <option value="" disabled>Select Status</option>
              <option value="APPROVED">APPROVED</option>
              <option value="PENDING">PENDING</option>
              <option value="EXPIRING">EXPIRING</option>
            </select>
            <div
              *ngIf="editDriverStatusModel.invalid && (editDriverStatusModel.dirty || editDriverStatusModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editDriverStatusModel.errors?.['required']">Status is required.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Pre-employment Clearing House Date</label>
            <input type="date" class="form-control" [(ngModel)]="driverToEdit.clearingHouseDate"
              name="editClearingHouseDate" #editClearingHouseDateModel="ngModel">
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Termination Date</label>
            <input type="date" class="form-control" [(ngModel)]="driverToEdit.terminationDate"
              name="editTerminationDate" #editTerminationDateModel="ngModel">
          </div>
          <div class="col-md-3">
            <label>Reason For Leaving / Termination</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.reasonForLeaving"
              name="editReasonForLeaving" pattern="^[a-zA-Z\s]*$" maxlength="50" #editReasonForLeavingModel="ngModel">
            <div
              *ngIf="editReasonForLeavingModel.invalid && (editReasonForLeavingModel.dirty || editReasonForLeavingModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editReasonForLeavingModel.errors?.['pattern']">Only letters allowed.</span>
            </div>
          </div>
          <div class="col-md-3">
            <label>Company</label>
            <select class="form-control" [(ngModel)]="driverToEdit.companyId" name="editCompanyId" required
              #editCompanyIdModel="ngModel">
              <option value="" disabled>Select Company</option>
              <option *ngFor="let company of companies" [value]="company._id">
                {{ company.companyName }}
              </option>
            </select>
            <div
              *ngIf="editCompanyIdModel.invalid && (editCompanyIdModel.dirty || editCompanyIdModel.touched || editForm.submitted)"
              class="text-danger font-12">
              <span *ngIf="editCompanyIdModel.errors?.['required']">Company is required.</span>
            </div>
          </div>
        </div>
        <div class="row mt-3 align-items-center">
          <label class="col-auto mb-0">Do you have legal right to work in the United States?</label>
          <div class="col-auto mt-2">
            <label class="me-3">
              <input type="radio" [(ngModel)]="driverToEdit.legalRight" name="editLegalRight" value="yes"> Yes
            </label>
            <label>
              <input type="radio" [(ngModel)]="driverToEdit.legalRight" name="editLegalRight" value="no"> No
            </label>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-3">
            <label>Work Authorization</label>
            <select class="form-control" [(ngModel)]="driverToEdit.workAuthorization" name="editWorkAuthorization">
              <option value="" disabled>Select Work Authorization</option>
              <option value="CITIZEN">CITIZEN</option>
              <option value="PR/GREEN CARD">PR/GREEN CARD</option>
              <option value="WORK PERMIT">WORK PERMIT</option>
            </select>
          </div>
          <div class="col-md-3" *ngIf="driverToEdit.workAuthorization === 'WORK PERMIT'">
            <label>Work Permit USCIS No</label>
            <input type="text" class="form-control" [(ngModel)]="driverToEdit.workPermitUSCIS"
              name="editWorkPermitUSCIS">
          </div>
          <div class="col-md-3" *ngIf="driverToEdit.workAuthorization === 'WORK PERMIT'">
            <label>Work Permit Expiration Date</label>
            <input type="date" class="form-control" [(ngModel)]="driverToEdit.workPermitExpiration"
              name="editWorkPermitExpiration">
          </div>
        </div>
        <h4 class="mt-4 mb-3 border-bottom pb-2">PREVIOUS THREE YEARS RESIDENCY</h4>
        <table class="table table-bordered align-middle" style="background: #fff;">
          <thead class="table-light">
            <tr>
              <th style="width:18%"></th>
              <th style="width:25%">STREET</th>
              <th style="width:15%">CITY</th>
              <th style="width:12%">STATE</th>
              <th style="width:15%">ZIPCODE</th>
              <th style="width:15%">#OF YEARS AT ADDRESS</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>CURRENT ADDRESS</b></td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.currentAddressStreet"
                  name="editCurrentAddressStreet">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.currentAddressCity"
                  name="editCurrentAddressCity" required pattern="^[a-zA-Z\s]*$" #editCurrentAddressCityModel="ngModel">
                <div
                  *ngIf="editCurrentAddressCityModel.invalid && (editCurrentAddressCityModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editCurrentAddressCityModel.errors?.['required']">City is required.</span>
                  <span *ngIf="editCurrentAddressCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
                </div>
              </td>
              <td>
                <div style="position: relative; min-width: 150px;">
                  <div class="form-control" (click)="editDropdownOpen = !editDropdownOpen; $event.stopPropagation()"
                    style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                    {{ getStateName(driverToEdit.currentAddressState) || 'Select State' }}
                  </div>
                  <ul *ngIf="editDropdownOpen" (click)="$event.stopPropagation()"
                    style="position: absolute; left: 0; top: 100%; width: 100%; z-index: 1000; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px; box-sizing: border-box;">
                    <li *ngFor="let state of usStates"
                      (click)="selectEditState(state.abbr); editDropdownOpen = false; $event.stopPropagation()"
                      style="padding: 8px; cursor: pointer;" (mouseover)="editHovered = state.abbr"
                      (mouseout)="editHovered = null"
                      [style.backgroundColor]="editHovered === state.abbr ? '#eee' : 'white'">
                      {{ state.name }}
                    </li>
                  </ul>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.currentAddressZipcode"
                  name="editCurrentAddressZipcode" pattern="^[0-9]*$" maxlength="9" required
                  #editCurrentAddressZipcodeModel="ngModel">
                <div
                  *ngIf="editCurrentAddressZipcodeModel.invalid && (editCurrentAddressZipcodeModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editCurrentAddressZipcodeModel.errors?.['required']">Zipcode is required.</span>
                  <span *ngIf="editCurrentAddressZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" name="editCurrentAddressYears"
                  [(ngModel)]="driverToEdit.currentAddressYears" pattern="^[0-9]*$"
                  #editCurrentAddressYearsModel="ngModel" required />
                <div
                  *ngIf="editCurrentAddressYearsModel.invalid && (editCurrentAddressYearsModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editCurrentAddressYearsModel.errors?.['required']">This field is required.</span>
                  <span *ngIf="editCurrentAddressYearsModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
            </tr>
            <tr>
              <td><b>MAILING ADDRESS</b></td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.mailingAddressStreet"
                  name="editMailingAddressStreet">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.mailingAddressCity"
                  name="editMailingAddressCity" required pattern="^[a-zA-Z\s]*$" #editMailingAddressCityModel="ngModel">
                <div
                  *ngIf="editMailingAddressCityModel.invalid && (editMailingAddressCityModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editMailingAddressCityModel.errors?.['required']">City is required.</span>
                  <span *ngIf="editMailingAddressCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
                </div>
              </td>
              <td class="relative">
                <div class="form-control"
                  (click)="editMailingDropdownOpen = !editMailingDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(driverToEdit.mailingAddressState) || 'Select State' }}
                </div>
                <ul *ngIf="editMailingDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                  <li *ngFor="let state of usStates"
                    (click)="selectEditMailingState(state.abbr); editMailingDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="editMailingHovered = state.abbr"
                    (mouseout)="editMailingHovered = null"
                    [style.backgroundColor]="editMailingHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.mailingAddressZipcode"
                  name="editMailingAddressZipcode" pattern="^[0-9]*$" maxlength="10" required
                  #editMailingAddressZipcodeModel="ngModel">
                <div
                  *ngIf="editMailingAddressZipcodeModel.invalid && (editMailingAddressZipcodeModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editMailingAddressZipcodeModel.errors?.['required']">Zipcode is required.</span>
                  <span *ngIf="editMailingAddressZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.mailingAddressYears"
                  name="editMailingAddressYears" pattern="^[0-9]*$" #editMailingAddressYearsModel="ngModel" required>
                <div
                  *ngIf="editMailingAddressYearsModel.invalid && (editMailingAddressYearsModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editMailingAddressYearsModel.errors?.['required']">This field is required.</span>
                  <span *ngIf="editMailingAddressYearsModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
            </tr>
            <tr>
              <td><b>PREVIOUS ADDRESS</b></td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.previousAddressStreet"
                  name="editPreviousAddressStreet">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.previousAddressCity"
                  name="editPreviousAddressCity" required pattern="^[a-zA-Z\s]*$"
                  #editPreviousAddressCityModel="ngModel">
                <div
                  *ngIf="editPreviousAddressCityModel.invalid && (editPreviousAddressCityModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editPreviousAddressCityModel.errors?.['required']">City is required.</span>
                  <span *ngIf="editPreviousAddressCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
                </div>
              </td>
              <td class="relative">
                <div class="form-control"
                  (click)="editPreviousDropdownOpen = !editPreviousDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(driverToEdit.previousAddressState) || 'Select State' }}
                </div>
                <ul *ngIf="editPreviousDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                  <li *ngFor="let state of usStates"
                    (click)="selectEditPreviousState(state.abbr); editPreviousDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="editPreviousHovered = state.abbr"
                    (mouseout)="editPreviousHovered = null"
                    [style.backgroundColor]="editPreviousHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.previousAddressZipcode"
                  name="editPreviousAddressZipcode" pattern="^[0-9]*$" maxlength="10" required
                  #editPreviousAddressZipcodeModel="ngModel">
                <div
                  *ngIf="editPreviousAddressZipcodeModel.invalid && (editPreviousAddressZipcodeModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editPreviousAddressZipcodeModel.errors?.['required']">Zipcode is required.</span>
                  <span *ngIf="editPreviousAddressZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.previousAddressYears"
                  name="editPreviousAddressYears" pattern="^[0-9]*$" required #editPreviousAddressYearsModel="ngModel">
                <div
                  *ngIf="editPreviousAddressYearsModel.invalid && (editPreviousAddressYearsModel.touched || editForm.submitted)"
                  class="text-danger font-12">
                  <span *ngIf="editPreviousAddressYearsModel.errors?.['required']">Years at address is required.</span>
                  <span *ngIf="editPreviousAddressYearsModel.errors?.['pattern']">Only numbers allowed.</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <h4 class="mt-4 mb-3 border-bottom pb-2">LICENSE INFORMATION</h4>
        <table class="table table-bordered align-middle" style="background: #fff;">
          <thead class="table-light">
            <tr>
              <th style="width:18%"></th>
              <th style="width:15%">STATE</th>
              <th style="width:18%">LICENSE NO</th>
              <th style="width:15%">TYPE/CLASS</th>
              <th style="width:15%">ENDORSEMENTS</th>
              <th style="width:14%">ISSUE DATE</th>
              <th style="width:15%">EXPIRATION DATE</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>CURRENT CDL</b></td>
              <td style="position: relative; min-width: 150px;">
                <!-- Dropdown Button -->
                <div class="form-control"
                  (click)="editCurrentCdlDropdownOpen = !editCurrentCdlDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(driverToEdit.currentCdlState) || 'Select State' }}
                </div>
                <!-- Dropdown List -->
                <ul *ngIf="editCurrentCdlDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; left: 0; right: 0; top: 100%; width: 100%; z-index: 1000; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px; box-sizing: border-box;">
                  <li *ngFor="let state of usStates"
                    (click)="selectEditCurrentCdlState(state.abbr); editCurrentCdlDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="editCurrentCdlHovered = state.abbr"
                    (mouseout)="editCurrentCdlHovered = null"
                    [style.backgroundColor]="editCurrentCdlHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.currentCdlNumber"
                  name="editCurrentCdlNumber" pattern="^[a-zA-Z0-9]*$">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.currentCdlType"
                  name="editCurrentCdlType" pattern="^[a-zA-Z\s]*$">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.currentCdlEndorsements"
                  name="editCurrentCdlEndorsements">
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.currentCdlIssueDate"
                    name="editCurrentCdlIssueDate">
                </div>
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.currentCdlExpirationDate"
                    name="editCurrentCdlExpirationDate">
                </div>
              </td>
            </tr>
            <tr>
              <td><b>OLD CDL</b></td>
              <td class="relative">
                <!-- Dropdown Button -->
                <div class="form-control"
                  (click)="editOldCdlDropdownOpen = !editOldCdlDropdownOpen; $event.stopPropagation()"
                  style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                  {{ getStateName(driverToEdit.oldCdlState) || 'Select State' }}
                </div>
                <!-- Dropdown List -->
                <ul *ngIf="editOldCdlDropdownOpen" (click)="$event.stopPropagation()"
                  style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                  <li *ngFor="let state of usStates"
                    (click)="selectEditOldCdlState(state.abbr); editOldCdlDropdownOpen = false; $event.stopPropagation()"
                    style="padding: 8px; cursor: pointer;" (mouseover)="editOldCdlHovered = state.abbr"
                    (mouseout)="editOldCdlHovered = null"
                    [style.backgroundColor]="editOldCdlHovered === state.abbr ? '#eee' : 'white'">
                    {{ state.name }}
                  </li>
                </ul>
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.oldCdlNumber" name="editOldCdlNumber"
                  pattern="^[a-zA-Z0-9]*$">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.oldCdlType" name="editOldCdlType"
                  pattern="^[a-zA-Z\s]*$">
              </td>
              <td>
                <input type="text" class="form-control" [(ngModel)]="driverToEdit.oldCdlEndorsements"
                  name="editOldCdlEndorsements">
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.oldCdlIssueDate"
                    name="editOldCdlIssueDate">
                </div>
              </td>
              <td>
                <div style="position: relative;">
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.oldCdlExpirationDate"
                    name="editOldCdlExpirationDate">
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <!-- Add more fields as needed, matching your Add Driver form -->
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            (click)="closeEditModal()">Close</button>
          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
            (click)="activeSection = 'driving-info'">Next</button>
        </div>
      </div>

      <!-- Driving Experience Section -->
      <div class="content_ac" *ngIf="activeSection === 'driving-info'">
        <h3 class="mb-4">Driving Experience</h3>
        <!-- Copy your driving experience table here, but bind to driverToEdit.drivingExperiences -->
        <div class="col-12">
          <h5 class="mb-2">Driving Experience</h5>
          <table class="table table-bordered align-middle" style="background: #fff;">
            <thead class="table-light">
              <tr>
                <th>CLASS OF EQUIPMENT</th>
                <th>TYPE OF EQUIPMENT (VAN, TANK, FLAT, ETC.)</th>
                <th>DATE FROM</th>
                <th>DATE TO</th>
                <th>APPROX # OF MILES (TOTAL)</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let exp of driverToEdit.drivingExperiences; let i = index">
                <td>
                  <select class="form-control" [(ngModel)]="exp.classOfEquipment" name="editClassOfEquipment{{i}}"
                    required>
                    <option value="">-- Select Class --</option>
                    <option value="straight truck">Straight Truck</option>
                    <option value="tractor & semi-trailer">Tractor & Semi-Trailer</option>
                    <option value="tractor & tanker">Tractor & Tanker</option>
                    <option value="other">Other</option>
                  </select>
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="exp.typeOfEquipment"
                    name="editTypeOfEquipment{{i}}" required>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="exp.dateFrom" name="editDateFrom{{i}}"
                      required>
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="exp.dateTo" name="editDateTo{{i}}" required>
                  </div>
                </td>
                <td>
                  <input type="number" class="form-control" [(ngModel)]="exp.approxMiles" name="editApproxMiles{{i}}"
                    required min="0">
                  <div *ngIf="editF?.submitted && editF?.controls?.['editApproxMiles'+i]?.errors as errors"
                    class="text-danger font-12">
                    <span *ngIf="errors['min']">Must be positive.</span>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="btn btn-sm btn-outline-success mt-2"
            (click)="driverToEdit.drivingExperiences.push({})">
            <i class="fa fa-plus"></i> Add Row
          </button>
        </div>
        <div class="col-12 mt-4">
          <h5 class="mb-2">Accident Record for the Past 3 Years</h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" [(ngModel)]="driverToEdit.noAccidents"
              name="editNoAccidents" id="editNoAccidents">
            <label class="form-check-label" for="editNoAccidents">
              Check this box if you are not involved in any accident (Previous)
            </label>
          </div>
          <table class="table table-bordered align-middle" style="background: #fff;">
            <thead class="table-light">
              <tr>
                <th>DATE</th>
                <th>NATURE OF ACCIDENT (Head-on, rear-end, upset, etc.)</th>
                <th>FATALITIES</th>
                <th>INJURIES</th>
                <th>Remark (Driver Fault, Other Party Fault)</th>
                <th style="width: 40px;"></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let acc of driverToEdit.accidentRecords; let i = index">
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="acc.date" name="editAccidentDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="acc.nature" name="editAccidentNature{{i}}">
                </td>
                <td>
                  <input type="number" class="form-control" [(ngModel)]="acc.fatalities"
                    name="editAccidentFatalities{{i}}" min="0">
                </td>
                <td>
                  <input type="number" class="form-control" [(ngModel)]="acc.injuries" name="editAccidentInjuries{{i}}"
                    min="0">
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="acc.remark" name="editAccidentRemark{{i}}">
                </td>
                <td>
                  <button type="button" class="btn btn-danger btn-sm" (click)="driverToEdit.accidentRecords.splice(i,1)"
                    *ngIf="driverToEdit.accidentRecords.length > 1">
                    <i class="fa fa-trash"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="mt-2 btn btn-sm btn-outline-success"
            (click)="driverToEdit.accidentRecords.push({})">
            <i class="fa fa-plus"></i> Add Row
          </button>
        </div>
        <div class="col-12 mt-4">
          <h5 class="mb-2">Traffic Convictions and Forfeitures for the Past 3 Years (Other than Parking Violations)</h5>
          <div class="form-check mb-2">
            <input class="form-check-input" type="checkbox" [(ngModel)]="driverToEdit.noCitations"
              name="editNoCitations" id="editNoCitations">
            <label class="form-check-label" for="editNoCitations">
              Check this box if you are not charged for any citation
            </label>
          </div>
          <table class="table table-bordered align-middle" style="background: #fff;">
            <thead class="table-light">
              <tr>
                <th>STATE OF VIOLATION</th>
                <th>VIOLATION TYPE</th>
                <th>Ticket Date</th>
                <th>Conviction Date</th>
                <th>Remark (Guilty, Reduce to Zero)</th>
                <th style="width: 40px;"></th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let vio of driverToEdit.trafficViolations; let i = index">
                <td>
                  <select class="form-control" [(ngModel)]="vio.stateOfViolation" name="editStateOfViolation{{i}}"
                    required>
                    <option value="">-- Select State --</option>
                    <option value="Test 1">Test 1</option>
                    <option value="Test 2">Test 2</option>
                    <option value="Test 3">Test 3</option>
                    <option value="other">Other</option>
                  </select>
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="vio.type" name="editViolationType{{i}}">
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="vio.ticketDate"
                      name="editViolationTicketDate{{i}}">
                  </div>
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="vio.convictionDate"
                      name="editViolationConvictionDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="vio.remark" name="editViolationRemark{{i}}">
                </td>
                <td>
                  <button type="button" class="btn btn-danger btn-sm"
                    (click)="driverToEdit.trafficViolations.splice(i,1)"
                    *ngIf="driverToEdit.trafficViolations.length > 1">
                    <i class="fa fa-trash"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <button type="button" class="mt-2 btn btn-sm btn-outline-success"
            (click)="driverToEdit.trafficViolations.push({})">
            <i class="fa fa-plus"></i> Add Row
          </button>
        </div>
        <div class="col-12 mt-4">
          <div class="row">
            <div class="col-12 mb-3">
              <div class="d-flex align-items-center">
                <label class="font-weight-600 me-3 mb-0">
                  Have you ever been denied a license, permit, or privilege to operate a motor vehicle?
                </label>
                <div style="display: flex; gap: 20px;">
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="driverToEdit.licenseDenied" name="editLicenseDenied" value="YES">
                    YES
                  </label>
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="driverToEdit.licenseDenied" name="editLicenseDenied" value="NO"> NO
                  </label>
                </div>
              </div>
              <div *ngIf="driverToEdit.licenseDenied === 'YES'" class="mt-2">
                <textarea class="form-control" [(ngModel)]="driverToEdit.licenseDeniedExplain"
                  name="editLicenseDeniedExplain" placeholder="If Yes, Please explain" rows="3"></textarea>
              </div>
            </div>
            <div class="col-12 mb-3">
              <div class="d-flex align-items-center">
                <label class="font-weight-600 me-3 mb-0">
                  Has any license, permit, or privilege ever been suspended or revoked?
                </label>
                <div style="display: flex; gap: 20px;">
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="driverToEdit.licenseSuspended" name="editLicenseSuspended"
                      value="YES"> YES
                  </label>
                  <label class="mb-0">
                    <input type="radio" [(ngModel)]="driverToEdit.licenseSuspended" name="editLicenseSuspended"
                      value="NO"> NO
                  </label>
                </div>
              </div>
              <div *ngIf="driverToEdit.licenseSuspended === 'YES'" class="mt-2">
                <textarea class="form-control" [(ngModel)]="driverToEdit.licenseSuspendedExplain"
                  name="editLicenseSuspendedExplain" placeholder="If Yes, Please explain" rows="3"></textarea>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            (click)="activeSection = 'personal-info'">Back</button>
          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
            (click)="activeSection = 'employment-history'">Next</button>
        </div>
      </div>

      <!-- Employment History Section -->
      <div class="content_ac" *ngIf="activeSection === 'employment-history'">
        <h3 class="mb-4">Employment History</h3>
        <!-- Copy your employment history section here, but bind to driverToEdit.employmentHistory -->
        <div *ngFor="let emp of driverToEdit.employmentHistory; let i = index" class="border rounded p-3 mb-4 bg-white">
          <h5 class="mb-3">{{ i === 0 ? 'CURRENT (MOST RECENT) EMPLOYER' : (i === 1 ? 'SECOND (MOST RECENT) EMPLOYER' :
            'PREVIOUS EMPLOYER ' + (i+1)) }}</h5>
          <div class="row">
            <div class="col-md-4">
              <label>Company Name</label>
              <input type="text" class="form-control" [(ngModel)]="emp.companyName" name="editCompanyName{{i}}" required
                pattern="^[a-zA-Z ]*$" #editCompanyNameModel="ngModel">
              <div
                *ngIf="editCompanyNameModel.invalid && (editCompanyNameModel.dirty || editCompanyNameModel.touched || editForm.submitted)"
                class="text-danger font-12">
                <span *ngIf="editCompanyNameModel.errors?.['required']">Company Name is required.</span>
                <span *ngIf="editCompanyNameModel.errors?.['pattern']">Only letters allowed.</span>
              </div>
            </div>
            <div class="col-md-4">
              <label>Contact No</label>
              <input type="text" class="form-control" [(ngModel)]="emp.contactNo" name="editContactNo{{i}}"
                pattern="^[0-9\-()\s]+$" maxlength="10" #editContactNoModel="ngModel">
              <div
                *ngIf="editContactNoModel.invalid && (editContactNoModel.dirty || editContactNoModel.touched || editForm.submitted)"
                class="text-danger font-12">
                <span *ngIf="editContactNoModel.errors?.['pattern']">Only numbers allowed.</span>
              </div>
            </div>
            <div class="col-md-4">
              <label>Email</label>
              <input type="email" class="form-control" [(ngModel)]="emp.email" name="editEmail{{i}}" email
                #editEmailEmpModel="ngModel">
              <div
                *ngIf="editEmailEmpModel.invalid && (editEmailEmpModel.dirty || editEmailEmpModel.touched || editForm.submitted)"
                class="text-danger font-12">
                <span *ngIf="editEmailEmpModel.errors?.['email']">Invalid email format.</span>
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-4">
              <label>Company Address (Street)</label>
              <input type="text" class="form-control" [(ngModel)]="emp.street" name="editStreet{{i}}"
                #editStreetModel="ngModel">
            </div>
            <div class="col-md-3">
              <label>City</label>
              <input type="text" class="form-control" [(ngModel)]="emp.city" name="editCity{{i}}" required
                pattern="^[a-zA-Z\s]*$" #editCityModel="ngModel">
              <div *ngIf="editCityModel.invalid && (editCityModel.touched || editForm.submitted)"
                class="text-danger font-12 mt-1">
                <span *ngIf="editCityModel.errors?.['required']">City is required.</span>
                <span *ngIf="editCityModel.errors?.['pattern']">Only letters and spaces allowed.</span>
              </div>
            </div>
            <div class="col-md-3 relative">
              <label>State</label>
              <div class="form-control no-wrap" (click)="emp.dropdownOpen = !emp.dropdownOpen; $event.stopPropagation()"
                style="border: 1px solid #ccc; padding: 8px; border-radius: 4px; cursor: pointer;">
                {{ getStateName(emp.state) || 'Select State' }}
              </div>
              <ul *ngIf="emp.dropdownOpen" (click)="$event.stopPropagation()"
                style="position: absolute; z-index: 10; background: white; border: 1px solid #ccc; max-height: 160px; overflow-y: auto; margin-top: 2px; border-radius: 4px;">
                <li *ngFor="let state of usStates"
                  (click)="emp.state = state.abbr; emp.dropdownOpen = false; $event.stopPropagation()"
                  style="padding: 8px; cursor: pointer;" (mouseover)="emp.hovered = state.abbr"
                  (mouseout)="emp.hovered = null"
                  [style.backgroundColor]="emp.hovered === state.abbr ? '#eee' : 'white'">
                  {{ state.name }}
                </li>
              </ul>
            </div>
            <div class="col-md-2">
              <label>Zipcode</label>
              <input type="text" class="form-control" [(ngModel)]="emp.zipcode" name="editZipcode{{i}}"
                pattern="^[0-9]*$" maxlength="10" #editZipcodeModel="ngModel">
              <div
                *ngIf="editZipcodeModel.invalid && (editZipcodeModel.dirty || editZipcodeModel.touched || editForm.submitted)"
                class="text-danger font-12">
                <span *ngIf="editZipcodeModel.errors?.['pattern']">Only numbers allowed.</span>
              </div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-4">
              <label>Position Held</label>
              <select class="form-control" [(ngModel)]="emp.positionHeld" name="editPositionHeld{{i}}"
                #editPositionHeldModel="ngModel" required>
                <option value="">-- Select Position --</option>
                <option value="Test 1">Test 1</option>
                <option value="Test 2">Test 2</option>
                <option value="Test 3">Test 3</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="col-md-4">
              <label>Start Date</label>
              <input type="date" class="form-control" [(ngModel)]="emp.startDate" name="editStartDate{{i}}"
                #editStartDateModel="ngModel">
            </div>
            <div class="col-md-4">
              <label>End Date</label>
              <input type="date" class="form-control" [(ngModel)]="emp.endDate" name="editEndDate{{i}}"
                #editEndDateModel="ngModel">
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-6">
              <label>Reason For Leaving</label>
              <input type="text" class="form-control" [(ngModel)]="emp.reasonForLeaving"
                name="editReasonForLeaving{{i}}" #editReasonForLeavingEmpModel="ngModel">
            </div>
            <div class="col-md-6">
              <label>EXPLAIN ANY GAPS IN NEXT EMPLOYMENT (Include month/year & reason)</label>
              <input type="text" class="form-control" [(ngModel)]="emp.gapsExplanation" name="editGapsExplanation{{i}}"
                #editGapsExplanationModel="ngModel">
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-12 d-flex align-items-center">
              <label class="me-3">
                While employed here, were you subject to the Federal Motor Carrier Safety Regulations?
              </label>
              <label class="me-3 mb-0">
                <input type="radio" [(ngModel)]="emp.fmcsaSubject" name="editFmcsaSubject{{i}}" value="YES"> YES
              </label>
              <label class="mb-0">
                <input type="radio" [(ngModel)]="emp.fmcsaSubject" name="editFmcsaSubject{{i}}" value="NO"> NO
              </label>
            </div>
            <div class="col-md-12 d-flex align-items-center mt-2">
              <label class="me-3">
                Was the job designated as a safety-sensitive function in any DOT-regulated mode under 49 CFR part 40?
              </label>
              <label class="me-3 mb-0">
                <input type="radio" [(ngModel)]="emp.dotSensitive" name="editDotSensitive{{i}}" value="YES"> YES
              </label>
              <label class="mb-0">
                <input type="radio" [(ngModel)]="emp.dotSensitive" name="editDotSensitive{{i}}" value="NO"> NO
              </label>
            </div>
          </div>
          <div class="text-end mt-2" *ngIf="driverToEdit.employmentHistory.length > 1">
            <button type="button" class="btn btn-danger btn-sm" (click)="driverToEdit.employmentHistory.splice(i,1)">
              <i class="fa fa-trash"></i> Remove
            </button>
          </div>
        </div>
        <div class="mt-1">
          <button type="button" class="btn btn-outline-success btn-sm" (click)="driverToEdit.employmentHistory.push({
    companyName: '', contactNo: '', email: '', street: '', city: '', state: '', zipcode: '', positionHeld: '', startDate: '', endDate: '', reasonForLeaving: '', gapsExplanation: '', fmcsaSubject: '', dotSensitive: ''
  })">
            <i class="fa fa-plus"></i> Add Previous Employer
          </button>
        </div>
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            (click)="activeSection = 'driving-info'">Back</button>
          <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
            (click)="activeSection = 'document-info'">Next</button>
        </div>
      </div>

      <!-- Document Information Section -->
      <div class="content_ac" *ngIf="activeSection === 'document-info'">
        <h3 class="mb-4">Document Information</h3>
        <!-- Copy your document info table here, but bind to driverToEdit fields -->
        <!-- EDIT MODE: Document Upload Table -->
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Number</th>
                <th>Date / Expiry</th>
                <th>Upload Document</th>
              </tr>
            </thead>
            <tbody>
              <!-- CDL -->
              <tr>
                <td>CDL</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.cdlNumber" name="editCdlNumber"
                    pattern="^[a-zA-Z0-9 ]*$" #editCdlNumberModel="ngModel">
                  <div
                    *ngIf="editCdlNumberModel.invalid && (editCdlNumberModel.dirty || editCdlNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editCdlNumberModel.errors?.['pattern']">Only letters and numbers allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.cdlExpiry" name="editCdlExpiry"
                    #editCdlExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'cdlFile')">
                  <small *ngIf="getFileName('cdlFile')">{{ getFileName('cdlFile') }}</small>
                </td>
              </tr>
              <!-- Commercial Medical Certificate -->
              <tr>
                <td>Driver Commercial Medical Certificate</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.medicalCertificateNumber"
                    name="editMedicalCertificateNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editMedicalCertificateNumberModel="ngModel">
                  <div
                    *ngIf="editMedicalCertificateNumberModel.invalid && (editMedicalCertificateNumberModel.dirty || editMedicalCertificateNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editMedicalCertificateNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.medicalCertificateExpiry"
                    name="editMedicalCertificateExpiry" #editMedicalCertificateExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'medicalCertificateFile')">
                  <small *ngIf="getFileName('medicalCertificateFile')">{{ getFileName('medicalCertificateFile')
                    }}</small>
                </td>
              </tr>
              <!-- MVR Driving Record -->
              <tr>
                <td>DMV Driving Record</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.mvrNumber" name="editMvrNumber"
                    pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #editMvrNumberModel="ngModel">
                  <div
                    *ngIf="editMvrNumberModel.invalid && (editMvrNumberModel.dirty || editMvrNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editMvrNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.mvrPullDate" name="editMvrPullDate"
                    #editMvrPullDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'mvrFile')">
                  <small *ngIf="getFileName('mvrFile')">{{ getFileName('mvrFile') }}</small>
                </td>
              </tr>
              <!-- BACKGROUND CHECK DOCUMENT -->
              <tr>
                <td>Background Check Document</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.backgroundCheckNumber"
                    name="editBackgroundCheckNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editBackgroundCheckNumberModel="ngModel">
                  <div
                    *ngIf="editBackgroundCheckNumberModel.invalid && (editBackgroundCheckNumberModel.dirty || editBackgroundCheckNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editBackgroundCheckNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.backgroundCheckDate"
                    name="editBackgroundCheckDate" #editBackgroundCheckDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'backgroundCheckFile')">
                  <small *ngIf="getFileName('backgroundCheckFile')">{{ getFileName('backgroundCheckFile') }}</small>
                </td>
              </tr>
              <!-- PSP RECORD -->
              <tr>
                <td>PSP Record</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.pspNumber" name="editPspNumber"
                    pattern="^[a-zA-Z0-9\- ]*$" maxlength="30" #editPspNumberModel="ngModel">
                  <div
                    *ngIf="editPspNumberModel.invalid && (editPspNumberModel.dirty || editPspNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editPspNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.pspPullDate" name="editPspPullDate"
                    #editPspPullDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'pspFile')">
                  <small *ngIf="getFileName('pspFile')">{{ getFileName('pspFile') }}</small>
                </td>
              </tr>
              <!-- Work Authorization -->
              <tr>
                <td>Work Authorization Document</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.workAuthNumber"
                    name="editWorkAuthNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editWorkAuthNumberModel="ngModel">
                  <div
                    *ngIf="editWorkAuthNumberModel.invalid && (editWorkAuthNumberModel.dirty || editWorkAuthNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editWorkAuthNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.workAuthExpiry"
                    name="editWorkAuthExpiry" #editWorkAuthExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'workAuthFile')">
                  <small *ngIf="getFileName('workAuthFile')">{{ getFileName('workAuthFile') }}</small>
                </td>
              </tr>
              <!-- SSN Card -->
              <tr>
                <td>SSN Card</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.ssnNumber" name="editSsnNumber"
                    pattern="^[0-9\-]*$" maxlength="9" placeholder="XXX-XX-XXXX" #editSsnNumberModel="ngModel">
                  <div
                    *ngIf="editSsnNumberModel.invalid && (editSsnNumberModel.dirty || editSsnNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editSsnNumberModel.errors?.['pattern']">Only numbers and - allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.pspPullDate" name="editSsnCardDate"
                    #editSsnCardDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'ssnFile')">
                  <small *ngIf="getFileName('ssnFile')">{{ getFileName('ssnFile') }}</small>
                </td>
              </tr>
              <!-- Pre-employment Clearing House -->
              <tr>
                <td>Pre-employment Clearing House</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.preClearingHouseNumber"
                    name="editPreClearingHouseNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editPreClearingHouseNumberModel="ngModel">
                  <div
                    *ngIf="editPreClearingHouseNumberModel.invalid && (editPreClearingHouseNumberModel.dirty || editPreClearingHouseNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editPreClearingHouseNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.preClearingHouseExpiry"
                    name="editPreClearingHouseExpiry" #editPreClearingHouseExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'preClearingHouseFile')">
                  <small *ngIf="getFileName('preClearingHouseFile')">{{ getFileName('preClearingHouseFile') }}</small>
                </td>
              </tr>
              <!-- Pre-employment Drug Test CCF -->
              <tr>
                <td>Pre-employment Drug Test CCF</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.preDrugTestCCFNumber"
                    name="editPreDrugTestCCFNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editPreDrugTestCCFNumberModel="ngModel">
                  <div
                    *ngIf="editPreDrugTestCCFNumberModel.invalid && (editPreDrugTestCCFNumberModel.dirty || editPreDrugTestCCFNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editPreDrugTestCCFNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.preDrugTestCCFDate"
                    name="editPreDrugTestCCFDate" #editPreDrugTestCCFDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'preDrugTestCCFFile')">
                  <small *ngIf="getFileName('preDrugTestCCFFile')">{{ getFileName('preDrugTestCCFFile') }}</small>
                </td>
              </tr>
              <!-- Pre-employment Drug Test Result -->
              <tr>
                <td>Pre-employment Drug Test Result</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.preDrugTestResultNumber"
                    name="editPreDrugTestResultNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editPreDrugTestResultNumberModel="ngModel">
                  <div
                    *ngIf="editPreDrugTestResultNumberModel.invalid && (editPreDrugTestResultNumberModel.dirty || editPreDrugTestResultNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editPreDrugTestResultNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.preDrugTestResultDate"
                    name="editPreDrugTestResultDate" #editPreDrugTestResultDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'preDrugTestResultFile')">
                  <small *ngIf="getFileName('preDrugTestResultFile')">{{ getFileName('preDrugTestResultFile') }}</small>
                </td>
              </tr>
              <!-- ANNUAL CLEARING HOUSE -->
              <tr>
                <td>Annual Clearing House</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.annualClearingHouseNumber"
                    name="editAnnualClearingHouseNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editAnnualClearingHouseNumberModel="ngModel">
                  <div
                    *ngIf="editAnnualClearingHouseNumberModel.invalid && (editAnnualClearingHouseNumberModel.dirty || editAnnualClearingHouseNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editAnnualClearingHouseNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.annualClearingHouseExpiry"
                    name="editAnnualClearingHouseExpiry" #editAnnualClearingHouseExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'annualClearingHouseFile')">
                  <small *ngIf="getFileName('annualClearingHouseFile')">{{ getFileName('annualClearingHouseFile')
                    }}</small>
                </td>
              </tr>
              <!-- PULL NOTICE -->
              <tr>
                <td>Pull Notice</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.pullNoticeNumber"
                    name="editPullNoticeNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editPullNoticeNumberModel="ngModel">
                  <div
                    *ngIf="editPullNoticeNumberModel.invalid && (editPullNoticeNumberModel.dirty || editPullNoticeNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editPullNoticeNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.pullNoticeExpiry"
                    name="editPullNoticeExpiry" #editPullNoticeExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'pullNoticeFile')">
                  <small *ngIf="getFileName('pullNoticeFile')">{{ getFileName('pullNoticeFile') }}</small>
                </td>
              </tr>
              <!-- FMCSA National Registry -->
              <tr>
                <td>FMCSA National Registry</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.nationalRegistryNumber"
                    name="editNationalRegistryNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editNationalRegistryNumberModel="ngModel">
                  <div
                    *ngIf="editNationalRegistryNumberModel.invalid && (editNationalRegistryNumberModel.dirty || editNationalRegistryNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editNationalRegistryNumberModel.errors?.['pattern']">Only letters, numbers, -
                      allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.nationalRegistryExpiry"
                    name="editNationalRegistryExpiry" #editNationalRegistryExpiryModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'nationalRegistryFile')">
                  <small *ngIf="getFileName('nationalRegistryFile')">{{ getFileName('nationalRegistryFile') }}</small>
                </td>
              </tr>
              <!-- Driver Road Test -->
              <tr>
                <td>Driver Road Test / Driver Proficiency & Vehicle Authorization Docs</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="driverToEdit.roadTestNumber"
                    name="editRoadTestNumber" pattern="^[a-zA-Z0-9\- ]*$" maxlength="30"
                    #editRoadTestNumberModel="ngModel">
                  <div
                    *ngIf="editRoadTestNumberModel.invalid && (editRoadTestNumberModel.dirty || editRoadTestNumberModel.touched || editF.submitted)"
                    class="text-danger font-12">
                    <span *ngIf="editRoadTestNumberModel.errors?.['pattern']">Only letters, numbers, - allowed.</span>
                  </div>
                </td>
                <td>
                  <input type="date" class="form-control" [(ngModel)]="driverToEdit.roadTestDate"
                    name="editRoadTestDate" #editRoadTestDateModel="ngModel">
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'roadTestFile')">
                  <small *ngIf="getFileName('roadTestFile')">{{ getFileName('roadTestFile') }}</small>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <hr>

        <!-- EDIT MODE: RANDOM DRUG TEST CCF (multiple allowed) -->
        <h3 class="mb-4">RANDOM DRUG TEST CCF (Edit)</h3>
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Number</th>
                <th>Date</th>
                <th>Upload Document</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let randomCCF of driverToEdit.randomDrugTestCCFs; let i = index">
                <td>RANDOM DRUG TEST CCF</td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="randomCCF.number"
                    name="editRandomDrugTestCCFNumber{{i}}">
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="randomCCF.date"
                      name="editRandomDrugTestCCFDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control"
                    (change)="driverEditFile($event, 'editRandomDrugTestCCFFile' + i)">
                  <small *ngIf="getFileName('editRandomDrugTestCCFFile' + i)">
                    {{ getFileName('editRandomDrugTestCCFFile' + i) }}
                  </small>
                  <div *ngIf="randomCCF.fileName && !getFileName('editRandomDrugTestCCFFile' + i)">
                    <small>Current: {{ randomCCF.fileName }}</small>
                  </div>
                </td>
                <td>
                  <button type="button" class="btn btn-danger btn-sm"
                    (click)="driverToEdit.randomDrugTestCCFs.length > 1 && driverToEdit.randomDrugTestCCFs.splice(i, 1)"
                    [disabled]="driverToEdit.randomDrugTestCCFs.length === 1">
                    <i class="fa fa-trash"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-success btn-sm"
              (click)="driverToEdit.randomDrugTestCCFs.push({ number: '', date: '' })">
              <i class="fa fa-plus"></i> Add Random Drug Test CCF
            </button>
            <button *ngIf="driverToEdit.randomDrugTestCCFs.length > 0" type="button" class="btn btn-danger btn-sm"
              (click)="driverToEdit.randomDrugTestCCFs.length > 1 && driverToEdit.randomDrugTestCCFs.splice(driverToEdit.randomDrugTestCCFs.length - 1, 1)"
              [disabled]="driverToEdit.randomDrugTestCCFs.length === 1">
              Remove Last
            </button>
          </div>
        </div>
        <hr>
        <h3 class="mb-4">RANDOM DRUG TEST RESULT (Edit)</h3>
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Number</th>
                <th>Date</th>
                <th>Upload Document</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let randomResult of driverToEdit.randomDrugTestResults; let i = index">
                <td>
                  RANDOM DRUG TEST RESULT
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="randomResult.number"
                    name="editRandomDrugTestResultNumber{{i}}">
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="randomResult.date"
                      name="editRandomDrugTestResultDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control"
                    (change)="driverEditFile($event, 'editRandomDrugTestResultFile' + i)">
                  <small *ngIf="getFileName('editRandomDrugTestResultFile' + i)">
                    {{ getFileName('editRandomDrugTestResultFile' + i) }}
                  </small>
                  <div *ngIf="randomResult.fileName && !getFileName('editRandomDrugTestResultFile' + i)">
                    <small>Current: {{ randomResult.fileName }}</small>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-success btn-sm" (click)="addRandomDrugTestResult()">
              <i class="fa fa-plus"></i> Add Random Drug Test Result
            </button>
            <button *ngIf="driverToEdit.randomDrugTestResults.length > 0" type="button" class="btn btn-danger btn-sm"
              (click)="removeRandomDrugTestResult(driverToEdit.randomDrugTestResults.length - 1)"
              [disabled]="driverToEdit.randomDrugTestResults.length === 1">
              Remove Last
            </button>
          </div>
        </div>
        <h3 class="mb-4">Miscellaneous Document (Edit)</h3>
        <div class="table-responsive">
          <table class="table table-bordered align-middle bg-white">
            <thead class="table-light">
              <tr>
                <th>Document</th>
                <th>Value / Name</th>
                <th>Date</th>
                <th>Upload Document</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let misc of driverToEdit.miscDocuments; let i = index">
                <td>
                  Miscellaneous Document
                </td>
                <td>
                  <input type="text" class="form-control" [(ngModel)]="misc.name" name="editMiscDocumentName{{i}}"
                    placeholder="Document Name">
                </td>
                <td>
                  <div style="position: relative;">
                    <input type="date" class="form-control" [(ngModel)]="misc.date" name="editMiscDocumentDate{{i}}">
                  </div>
                </td>
                <td>
                  <input type="file" class="form-control" (change)="driverEditFile($event, 'editMiscDocumentFile' + i)">
                  <small *ngIf="getFileName('editMiscDocumentFile' + i)">
                    {{ getFileName('editMiscDocumentFile' + i) }}
                  </small>
                  <div *ngIf="misc.fileName && !getFileName('editMiscDocumentFile' + i)">
                    <small>Current: {{ misc.fileName }}</small>
                  </div>
                </td>
                <td>
                  <button type="button" class="btn btn-danger btn-sm"
                    (click)="driverToEdit.miscDocuments.length > 1 && driverToEdit.miscDocuments.splice(i, 1)"
                    [disabled]="driverToEdit.miscDocuments.length === 1">
                    <i class="fa fa-trash"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-outline-success btn-sm"
              (click)="driverToEdit.miscDocuments.push({ name: '', date: '' })">
              <i class="fa fa-plus"></i> Add Miscellaneous Document
            </button>
            <button *ngIf="driverToEdit.miscDocuments.length > 0" type="button" class="btn btn-danger btn-sm"
              (click)="driverToEdit.miscDocuments.length > 1 && driverToEdit.miscDocuments.splice(driverToEdit.miscDocuments.length - 1, 1)"
              [disabled]="driverToEdit.miscDocuments.length === 1">
              Remove Last
            </button>
          </div>
        </div>
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            (click)="activeSection = 'employment-history'">Back</button>
          <button type="submit" class="btn btn-success btn-sm text-uppercase rounded-pill"
            [disabled]="!editForm.valid || !hasChanges()">Save Changes</button>
        </div>
      </div>
    </form>
  </div>
</div>