<app-navbar></app-navbar>

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<main id="main" class="main mt-0 p-0">
  <div id="kt_app_content" class="app-content flex-column-fluid">
    <div class="container-fluid px-5">
      <div class="row bg-white px-3 py-4 mt-3 rounded">
        <div class="col-md-12">
          <!-- Default Tabs -->
          <ul class="nav nav-pills gap-2 border-bottom pb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link rounded-pill active" id="home-tab" data-bs-toggle="tab" data-bs-target="#customer"
                type="button" role="tab" aria-controls="home" aria-selected="true">Customer Data</button>
            </li>

          </ul>
          <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade active show" id="customer" role="tabpanel" aria-labelledby="home-tab">
              <div id="kt_app_content" class="app-content flex-column-fluid">
                <div class="my-4">
                  <div class="row">
                    <div class="col-md-12">
                      <div class="d-flex justify-content-between">
                        <div class="form-group has-search mb-0">
                          <span class="fa fa-search form-control-feedback"></span>
                          <input style="height: 36px !important;" type="text" name="Search" class="form-control"
                            placeholder="Search...">
                        </div>
                        <button class="btn btn-success rounded-pill font-14" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#addLocation" aria-controls="addLocation">
                        <i class="fa fa-plus me-2" aria-hidden="true"></i>Add
                      </button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-lg-12">
                    <div class="table-responsive">
                      <table class="table table-bordered">
                        <thead>
                          <tr>
                            <th scope="col">Company</th>
                            <th scope="col">Company Name</th>
                            <th scope="col">File Name</th>
                            <th scope="col">File Description</th>
                            <th scope="col" width="30px">Actions</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let file of files">
                            <!-- <td><a class="text-primary" href="file-info-view.html">{{ file.companyName }}</a></td> -->
                            <td>{{ file.companyName }}</td>
                            <td>{{ findCompanyName(file.companyId) }}</td> 
                            <td><span class="edit-text font-14 font-weight-500 mb-2">
                              <a [href]="file.fileUpload" target="_blank">
                                {{ file.fileUpload | slice:(file.fileUpload.lastIndexOf('/')+1) }}
                              </a>
                            </span>
                            </td>
                            <td>{{ file.description }}</td>


                            <td class="text-capitalize text-center">
                              <div class="dropdown filter-dropdown" style="position: fixed;">
                                <span class="dropdown-toggle font-16 px-3" type="button" id="dropdownMenuButton23"
                                  data-bs-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i>
                                </span>
                                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
                                  <a href="javascript:;" class="dropdown-item assigned font-13"
                                    (click)="editFile(file)" type="button" data-bs-toggle="offcanvas"
                                    data-bs-target="#ExtralargeModalEdit" aria-controls="offcanvasRight">Edit</a>
                                    <a class="dropdown-item assigned font-13" href="javascript:;" data-bs-toggle="modal"
                                    data-bs-target="#ExtralargeModalDelete"
                                    (click)="setFileToDelete(file)">Delete</a>
                                </div>
                              </div>
                            </td>

                       
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="row bg-white px-3 py-4 mt-3 rounded">
                  <div class="col-md-12">
                    <!-- <nav aria-label="Page navigation example ms-auto me-auto">
                      <ul class="pagination justify-content-center gap-2 mb-0">
                        <li class="page-item">
                          <a class="page-link font-22" href="javascript:;" aria-label="Previous"><i
                              class="fa fa-angle-left font-weight-300"></i></a>
                        </li>
                        <li class="page-item active"><a class="page-link font-14" href="javascript:;">1</a></li>
                        <li class="page-item"><a class="page-link font-14" href="javascript:;">2</a></li>
                        <li class="page-item"><a class="page-link font-14" href="javascript:;">3</a></li>
                        <li class="page-item"><a class="page-link font-14" href="javascript:;">4</a></li>
                        <li class="page-item"><a class="page-link font-14" href="javascript:;">5</a></li>
                        <li class="page-item"><a class="page-link font-22" href="javascript:;" aria-label="Next"><i
                              class="fa fa-angle-right font-weight-300"></i></a></li>
                      </ul>
                    </nav> -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- End Default Tabs -->


<!-- ======= Footer ======= -->
<footer id="footer" class="footer">
  <div class="text-dark text-center">
    <span class="text-muted fw-semibold me-1">2023© all rights reserved</span>
    <a class="text-muted fw-semibold text-hover-primary">Trucking</a> <!-- href="#" -->
  </div>

</footer>
<!-- End Footer -->



<!-- Trigger Button for Off-Canvas Form -->
<div class="modal fade" id="ExtralargeModalDelete" tabindex="-1" style="display: none;" aria-hidden="true">
  <div class="modal-dialog modal-md modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body">
        <h2 class="my-5 text-center"><i class="fa fa-exclamation-triangle text-danger" style="font-size: 60px;"></i>
        </h2>
        <h3 class="font-18 font-weight-700 text-center">Are you sure you want to Delete</h3>
      </div>
      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill px-3" data-bs-dismiss="modal"
          (click)="fileIdToDelete && deleteFile(fileIdToDelete)">Yes</button>
        <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill px-3"
          data-bs-dismiss="modal">No</button>
      </div>
    </div>
  </div>
</div>

<!-- Off-Canvas Form -->
<div class="offcanvas offcanvas-end" id="addLocation" aria-labelledby="offcanvasRightLabel" style="width: 80%;"
  data-bs-backdrop="static" data-bs-keyboard="false">
  <div class="offcanvas-header">
    <h5 id="offcanvasRightLabel">Add Customer Data</h5>
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body view-load position-relative">
    <form class="row g-3" (ngSubmit)="submitForm()" #customerForm="ngForm">
      <div class="col-md-4">
        <h2 class="font-14 font-weight-700">Company Name</h2>
        <input type="text" class="form-control" id="companyName" placeholder="Enter company name"
          [(ngModel)]="newFile.companyName" name="companyName" required>
      </div>
      <div class="col-md-4">
        <h2 class="font-14 font-weight-700">File Name</h2>
        <input type="file" class="form-control" id="fileName" placeholder="Enter File Name"
        (change)="onFileChange($event, 'fileUpload')" name="fileName" required>
      </div>
      <div class="col-md-4">
        <h2 class="font-14 font-weight-700">File Description</h2>
        <input type="text" class="form-control" id="fileDescription" placeholder="Enter File Description"
          [(ngModel)]="newFile.description" name="fileDescription" required>
      </div>

      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
          data-bs-dismiss="offcanvas">Close</button>
        <button type="submit" data-bs-dismiss="offcanvas"
          class="btn btn-success btn-sm text-uppercase rounded-pill">Save changes</button>
      </div>
    </form>
  </div>
</div>

<div class="offcanvas offcanvas-end" tabindex="-1" id="ExtralargeModalEdit" aria-labelledby="offcanvasRightLabel"
    style="width: 80%;" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-header" style="padding: 15px; border-bottom: 1px solid #ccc;">
      <h5 class="modal-title">Edit File</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body view-load position-relative">
      <form class="row g-3" (ngSubmit)=" updateFile()">
        <div class="col-md-4">
          <h2 class="font-14 font-weight-700">Company Name</h2>
          <input type="text" class="form-control" id="companyName" placeholder="Enter company name"
            [(ngModel)]="fileToEdit.companyName" name="companyName" required>
        </div>
        <div class="col-md-4">
          <h2 class="font-14 font-weight-700">File Name</h2>
          <input type="file" class="form-control" id="fileName" placeholder="Enter File Name"
          (change)="fileEditFile($event,'fileUpload')" name="fileName" required>
        </div>
        <div class="col-md-4">
          <h2 class="font-14 font-weight-700">File Description</h2>
          <input type="text" class="form-control" id="fileDescription" placeholder="Enter File Description"
            [(ngModel)]="fileToEdit.description" name="fileDescription" required>
        </div>

      
        <div class="modal-footer justify-content-center"
          style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
          <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
            data-bs-dismiss="offcanvas" style="margin: 10px;">Close</button>
          <button type="submit" class="btn btn-success btn-sm text-uppercase rounded-pill" data-bs-dismiss="offcanvas">Save changes</button>
        </div>
      </form>
     </div>
</div>

