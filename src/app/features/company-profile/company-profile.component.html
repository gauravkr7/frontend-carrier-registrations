<!-- <router-outlet></router-outlet> -->
<app-navbar (toggleSidebar)="toggleSidebar()"></app-navbar>

<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>




<section class="bg-color" [ngClass]="{'full-width': isSidebarOpen, 'shift-right': !isSidebarOpen}">
  <div class="container-fluid px-5" style="background-color: #c1c1c1; ">
    <!-- <div class="row">
      <div class="col-xl-12" style="background-color: #c1c1c1; margin-left:30px; ">
        <div class="my-4 ms-3 custom-header">
          <a *ngIf="showBackToDashboard" routerLink="/dashboard"
            class="btn btn-success rounded-pill font-14 active me-2" style="margin-left: 15px;">
            Back to Dashboard
          </a>
        </div>



      </div>
    </div> -->
    <div class="row border rounded px-3 py-5" *ngIf="getDot" style=" margin-left:50px; background-color:white;">
<div class="  d-flex justify-content-end">
  <a routerLink="/crm"
    class="btn btn-success rounded-pill font-14 active me-2">
    Back to List
  </a>
</div>
<hr class="custom-line">
      <div class="col-xl-5">
        <div class="mb-1Â d-flex">


          <h3 class="text-dark font-weight-700 mb-0" style="color: #3253dd !important;">{{companyData.companyName}}</h3>
        </div>
        <div class="d-flex align-items-center justify-content-left gap-5 mb-2">
          <div class="detail-1">
            <p class="text-capitalize">DOT - <span class="fw-bold text-main font-16">{{companyData.dot}}</span></p>
          </div>
          <div class="detail-2">
            <p class="text-capitalize">MC - <span class="fw-bold text-main font-16">{{companyData.mc}}</span></p>
          </div>
          <div class="detail-2">
            <p class="text-capitalize"><i class="fa fa-circle text-success" aria-hidden="true"></i> <span
                class="fw-bold text-main font-16">Active</span></p>
          </div>

        </div>
        <div class="row">
          <div class="detail-12">
            <p class="text-capitalize"><b> Contact Detail </b></p>
          </div>



          <div class="col-md-4">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1">
              </span>
              {{ getDot.dotData.record.content.carrier.legalName}}
            </a>

          </div>
          <div class="col-md-4">

            <a class="d-flex align-items-center text-dark font-weight-500 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bx-mobile"></i></span>
              {{companyData.Contract}}
            </a>
          </div>
          <div class="col-md-4">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bxs-envelope"></i></span>
              {{companyData.companyEmailAddress}}
            </a>
          </div>
          <div class="col-md-12">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bxl-periscope"></i></span>
              {{ getDot.dotData.record.content.carrier.phyStreet }},
            </a>
          </div>
          <div class="col-md-4">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bxl-periscope"></i></span>
              {{ getDot.dotData.record.content.carrier.phyCity }},
            </a>
          </div>
          <div class="col-md-4">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bxl-periscope"></i></span>
              {{ getDot.dotData.record.content.carrier.phyState }},
            </a>
          </div>
          <div class="col-md-4">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bxl-periscope"></i></span>
              {{ getDot.dotData.record.content.carrier.phyCountry }}
            </a>
          </div>
          <div class="col-md-4">
            <a class="d-flex align-items-center text-dark font-weight-500 me-5 mb-2">
              <span class="svg-icon svg-icon-4 me-1"><i class="bx bxl-periscope"></i></span>
              {{ getDot.dotData.record.content.carrier.phyZipcode }},
            </a>
          </div>
        </div>

        <div class="row mt-2">
          <div class="col-md-4">
            <p class="font-weight-600 mb-2">Company DBA</p>
            <h2 class="font-14 mb-1">{{ getDot.dotData.record.content.carrier.CompanyDBA }}</h2>
          </div>
          <div class="col-md-4">
            <p class="font-weight-600 mb-2">SCAC</p>
            <h2 class="font-14 mb-1">SCAC</h2>
          </div>
          <div class="col-md-4">
            <p class="font-weight-600 mb-2">TAX ID / EIN</p>
            <h2 class="font-14 mb-1">{{ getDot.dotData.record.content.carrier.ein
              }}</h2>
          </div>

        </div>

        <div class="row mt-4">
          <div class="col-lg-12 mb-3">
            <h6 class="font-14 font-weight-700"> <b>Authority</b></h6>
          </div>
          <div class="col-md-3">
            <div class="activeDiv ">
              <p class="font-weight-600 mb-1 ">Common</p>
              <p class="border rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between"
                style="border: 1px solid #28c76f !important;">
                <span class="font-weight-600">{{ getDot.dotData.record.content.carrier.commonAuthorityStatus
                  }}</span>
                <i class="fa fa-check text-success" aria-hidden="true"></i>
              </p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">Contract</p>
              <p
                class="bg-light rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between">
                <span class="font-weight-600">{{ getDot.dotData.record.content.carrier.Contract
                  }}</span>
              </p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">Broker</p>
              <p
                class="bg-light rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between">
                <span class="font-weight-600">{{ getDot.dotData.record.content.carrier.brokerAuthorityStatus
                  }}</span>
              </p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">Granted On</p>
              <p class="border rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between"
                style="border: 1px solid #28c76f !important;">
                <span class="font-weight-600">07-26-2024</span>
              </p>
            </div>
          </div>

        </div>

        <div class="row mt-3">
          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">DOT Status</p>
              <p class="border rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between"
                style="border: 1px solid #28c76f !important;">
                <span class="font-weight-600">{{ getDot.dotData.record.content.carrier.statusCode }}</span>
                <i class="fa fa-check text-success" aria-hidden="true"></i>
              </p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">DOT Date</p>
              <p class="border rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between"
                style="border: 1px solid #28c76f !important;">
                <span class="font-weight-600">07-26-2023</span>
              </p>
            </div>
          </div>

          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">Insurance</p>
              <p class="border rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between"
                style="border: 1px solid #28c76f !important;">
                <span class="font-weight-600">Active</span>
                <i class="fa fa-check text-success" aria-hidden="true"></i>
              </p>
            </div>
          </div>


          <div class="col-md-3">
            <div class="activeDiv">
              <p class="font-weight-600 mb-1">Certificate</p>
              <p
                class="bg-light rounded align-items-center px-3 py-1 text-black text-center mb-0 font-12 d-flex justify-content-between">
                <span class="font-weight-600">In-Active</span>
              </p>
            </div>
          </div>


        </div>
      </div>


      <div class="col-xl-7">
        <div class="row text-light">
          <div class="col-lg-3">
            <a routerLink="/truck-list">
              <div class="counter mb-3 bg-label-info same-size">
                <h2 class="timer count-title count-number" data-to="350" data-speed="1500">{{ totalTrucks }}</h2>
                <p class="count-text">Total Trucks</p>
              </div>
            </a>
            <a routerLink="/trailer-list">
              <div class="counter mb-3 bg-label-info same-size">
                <h2 class="timer count-title count-number" data-to="250" data-speed="1500">{{ totalTrailers }}</h2>
                <p class="count-text">Total Trailers</p>
              </div>
            </a>
            <a routerLink="/driver-list">
              <div class="counter bg-label-info same-size">
                <h2 class="timer count-title count-number" data-to="100" data-speed="1500">{{ totalDrivers }}</h2>
                <p class="count-text">Total Drivers</p>
              </div>
            </a>
          </div>
          <div class="col-lg-3">
            <a>
              <div class="counter mb-3 bg-label-danger same-size">
                <h2 class="timer count-title count-number" data-to="270" data-speed="1500">{{ nonCompliantTrucks }}</h2>
                <p class="count-text">Non-Compliant Trucks</p>
              </div>
            </a>
            <a>
              <div class="counter mb-3 bg-label-danger same-size">
                <h2 class="timer count-title count-number" data-to="180" data-speed="1500">{{ nonCompliantTrailers }}
                </h2>
                <p class="count-text">Non-Compliant Trailers</p>
              </div>
            </a>
            <a>
              <div class="counter bg-label-danger same-size">
                <h2 class="timer count-title count-number" data-to="120" data-speed="1500">{{ nonCompliantDrivers }}
                </h2>
                <p class="count-text">Non-Compliant Drivers</p>
              </div>
            </a>
          </div>
          <div class="col-lg-3">
            <a>
              <div class="counter mb-3 bg-label-success same-size">
                <h2 class="timer count-title count-number" data-to="320" data-speed="1500">{{ compliantTrucks }}</h2>
                <p class="count-text">Compliant Trucks</p>
              </div>
            </a>
            <a>
              <div class="counter mb-3 bg-label-success same-size">
                <h2 class="timer count-title count-number" data-to="200" data-speed="1500">{{ compliantTrailers }}</h2>
                <p class="count-text">Compliant Trailers</p>
              </div>
            </a>
            <a>
              <div class="counter bg-label-success same-size">
                <h2 class="timer count-title count-number" data-to="90" data-speed="1500">{{ compliantDrivers }}</h2>
                <p class="count-text">Compliant Drivers</p>
              </div>
            </a>
          </div>
          <div class="col-lg-3">
            <a>
              <div class="counter mb-3 bg-label-warning same-size">
                <h2 class="timer count-title count-number" data-to="210" data-speed="1500">{{ expiringTrucks }}</h2>
                <p class="count-text">Expiring Trucks</p>
              </div>
            </a>
            <a>
              <div class="counter mb-3 bg-label-warning same-size">
                <h2 class="timer count-title count-number" data-to="160" data-speed="1500">{{ expiringTrailers }}</h2>
                <p class="count-text">Expiring Trailers</p>
              </div>
            </a>
            <a>
              <div class="counter bg-label-warning same-size">
                <h2 class="timer count-title count-number" data-to="80" data-speed="1500">{{ expiringDrivers }}</h2>
                <p class="count-text">Expiring Drivers</p>
              </div>
            </a>
          </div>
        </div>
      </div>





    </div>





















    <!-- <a href="#" class="btn btn-success rounded-pill font-14 active me-2 ms-3">
              Company Profile
            </a> -->
    <div class="row bg-white px-3 mt-3 rounded cccc" style="margin-left: 50px; margin-top:-10px !important;">
      <div class="col-md-12">


        <!-- Edit Button -->

        <div class="flex-lg-row-fluid me-0">
          <!-- Card 1 -->
          <div class="row" *ngIf="companyData" style=" margin-right: -35px; margin-left: -35px; ">
            <div class="col-md-12">
              <div class="bg-white p-3">
                <div class="bg-light p-4 rounded-lg">
                  <!-- Row 1 -->
                  <div class="row">
                    <div class="col-md-2 mb-4">
                      <p class="fw-bold text-dark mb-2">Company Name</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.companyName}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">DBA Name</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.CompanyDBA}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Physical Address</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.companyPhysicalAddress}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Mailing Address</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.companyEmail}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">CA Phone Number</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.caNumber}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Email</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.companyEmail}}</h2>
                    </div>
                  </div>

                  <!-- Row 2 -->
                  <div class="row">
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Company Physical Address</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.phyStreet}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Company Physical City</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.phyCity}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Company Physical State</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.phyState}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Company Physical Zipcode</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.phyZipcode}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Company Phone Number</p>
                      <h2 class="semi-dark font-14 mb-1">{{companyData.phoneNumber}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Company Email</p>
                      <h2 class="  font-14 mb-1 semi-dark">{{companyData.companyEmail}}</h2>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>



          <!-- Card 2 -->
          <div class="row" *ngIf="companyData"
            style="margin-top: -10px; margin-bottom: -10px; margin-right: -35px; margin-left: -35px; ">
            <div class="col-md-12">
              <div class="bg-white p-3 ">
                <div class="bg-light p-4 rounded-lg">
                  <!-- Row 1 -->
                  <div class="row">
                    <div class="col-md-2 mb-4">
                      <p class="fw-bold text-dark mb-2">Insurance Broker Name</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.insuranceBrokerName}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Physical Address</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.companyPhysicalAddress}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Mailing Address</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.companyMailingAddress}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Mailing Address</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.companyEmailAddress}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Phone Number</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.Contract}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">EIN</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.ein}}</h2>
                    </div>

                  </div>

                  <!-- Row 2 -->
                  <div class="row">

                    <div class="col-md-2 mb-4">
                      <p class="fw-bold text-dark mb-2">KYU</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.kyu}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">KYU Expiration</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.kyuExpiration}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">New York Permit</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.ny}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">NY Expiration</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.nyExpiration}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">MC</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.mc}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">W9</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.w9}}</h2>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Card 3 -->
          <div class="row" *ngIf="companyData" style=" margin-right: -35px; margin-left: -35px; ">
            <div class="col-md-12">
              <div class="bg-white p-3 ">
                <div class="bg-light p-4 rounded-lg">
                  <!-- Row 1 -->
                  <div class="row bold-text">


                    <!-- <div class="row" style="font-size: medium; "> -->
                    <div class="col-md-2 mb-4">
                      <p class="fw-bold text-dark mb-2">DOT</p>
                      <h2 class="font-14  mb-1 semi-dark">{{companyData.dot}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Prepass</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.prepass}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">IFTA Account Number</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.iftaAcc}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">IRP Account Number</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.irpAcc}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Renewal Date</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.irpRenewalDate}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">Prepass Account Number</p>
                      <h2 class="font-14 mb-1 semi-dark ">{{companyData.accountsPermits.prepassAccountNumber}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">IFTA Account Number</p>
                      <h2 class="font-14 mb-1  semi-dark">{{companyData.accountsPermits.iftaAccountNumber}}</h2>
                    </div>
                    <div class="col-md-2 mb-3">
                      <p class="fw-bold text-dark mb-2">UCR Renewal Number</p>
                      <h2 class="font-14 mb-1 semi-dark">{{companyData.accountsPermits.ucrNumber}}</h2>
                    </div>
                  </div>

                  <!-- Row 2 -->
                </div>
              </div>
            </div>
          </div>














          <!-- Tabs Container -->
          <div class="bg-gray mx-n3 px-3 py-3 rounded">

            <!-- Tabs Header -->
            <ul class="nav nav-tabs mb-3" role="tablist">
              <li class="nav-item" role="presentation">
                <a class="nav-link active" id="activity-tab" data-bs-toggle="tab" href="#activity"
                  (click)="onTabChange('activity')">Activity</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="tasks-tab" data-bs-toggle="tab" href="#tasks"
                  (click)="onTabChange('tasks')">Tasks</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="services-tab" data-bs-toggle="tab" href="#services"
                  (click)="onTabChange('services')">Services</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="notes-tab" data-bs-toggle="tab" href="#notes"
                  (click)="onTabChange('notes')">Notes</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="carrier-profile-tab" data-bs-toggle="tab" href="#c-profile"
                  (click)="onTabChange('c-profile')">Carrier Profile</a>
              </li>
              <li class="nav-item" role="presentation">
                <a class="nav-link" id="carrier-contact-tab" data-bs-toggle="tab" href="#c-contact"
                  (click)="onTabChange('c-contact')">Carrier Contacts</a>
              </li>
            </ul>

            <!-- Add new button -->

            <div class="bg-white mb-3 p-3 rounded d-flex justify-content-end" *ngIf="showAddButton">
              <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill" data-bs-toggle="modal"
                [attr.data-bs-target]="getModalTarget()">
                <i class="fas fa-plus"></i> Add New {{ getButtonLabel() }}
              </button>
            </div>



            <!-- Bootstrap Modal -->
            <div class="modal fade" id="taskModal2" tabindex="-1" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered custom-small-modal">
                <div class="modal-content shadow-lg rounded-3">
                  <!-- Header -->
                  <div class="modal-header bg-light">
                    <h5 class="modal-title mb-0">{{ editingTask ? 'Edit Task' : 'Add Task' }}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>

                  <!-- Body -->
                  <div class="modal-body">
                    <form #taskForm="ngForm" (ngSubmit)="submitTask(taskForm)">

                      <!-- Task Title -->
                      <div class="mb-3">
                        <label for="taskTitle" class="form-label">Task Title</label>
                        <input type="text" id="taskTitle" name="title" class="form-control align-fix"
                          [(ngModel)]="taskEntries.title" placeholder="Enter task title" required />
                      </div>

                      <div class="mb-3">
                        <label for="taskDescription" class="form-label">Description</label>
                        <textarea id="taskDescription" name="description" rows="4" class="form-control align-fix"
                          [(ngModel)]="taskEntries.description" placeholder="Enter task description"></textarea>
                      </div>

                      <div class="mb-3 position-relative">
                        <label for="taskDueDate" class="form-label">Due Date</label>
                        <input type="date" id="taskDueDate" name="dueDate" class="form-control align-fix"
                          [(ngModel)]="taskEntries.dueDate" required />
                      </div>



                      <!-- Carrier Contact -->
                      <div class="mb-3">
                        <label for="carrierContact" class="form-label">Carrier Contact</label>
                        <select id="carrierContact" name="carrierContact" class="form-select"
                          [(ngModel)]="taskEntries.carrierContact" required>
                          <option value="">Select carrier contact</option>
                          <option *ngFor="let contact of carrierContacts" [value]="contact.fullName"
                            [hidden]="contact.companyId !== (selectedCrm?.companyId || selectedCrm?._id)">
                            {{ contact.fullName }} ({{ contact.jobTitle }})
                          </option>
                        </select>
                      </div>

                      <!-- Priority -->
                      <div class="mb-3">
                        <label for="taskPriority" class="form-label">Priority</label>
                        <select id="taskPriority" name="priority" class="form-select" [(ngModel)]="taskEntries.priority"
                          required>
                          <option value="low">Low</option>
                          <option value="medium">Medium</option>
                          <option value="high">High</option>
                        </select>
                      </div>

                      <!-- Assigned To -->
                      <div class="mb-3">
                        <label for="taskAssignedTo" class="form-label">Assigned To</label>
                        <select id="taskAssignedTo" name="assignedTo" class="form-select"
                          [(ngModel)]="taskEntries.assignedTo" required>
                          <option value="">Select team member</option>
                          <option *ngFor="let user of filteredSuperAdminUsers" [value]="user._id">
                            {{ user.name }} ({{ user.role | titlecase }})
                          </option>
                        </select>
                      </div>

                      <!-- Related To -->
                      <div class="mb-3">
                        <label for="taskRelatedTo" class="form-label">Related To</label>
                        <select id="taskRelatedTo" name="relatedTo" class="form-select"
                          [(ngModel)]="taskEntries.relatedTo">
                          <option value="">Select module</option>
                          <option value="carrier">Carrier Record</option>
                          <option value="compliance">Compliance</option>
                          <option value="factoring">Factoring</option>
                          <option value="eld">ELD</option>
                          <option value="tms">TMS</option>
                          <option value="billing">Billing</option>
                        </select>
                      </div>

                      <!-- Footer -->
                      <div class="modal-footer border-0">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                          <i class="fas fa-times me-2"></i> Cancel
                        </button>
                        <button data-bs-dismiss="modal" type="submit" class="btn btn-primary">
                          <i class="fas fa-plus me-2"></i> {{ editingTask ? 'Update Task' : 'Add Task' }}
                        </button>
                      </div>

                    </form>
                  </div>
                </div>
              </div>
            </div>

          </div>



          <!-- Bootstrap Modal for Task Completion -->
<div class="modal fade" id="taskModal1" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-md">
    <form class="modal-content" #completeTaskForm="ngForm" (ngSubmit)="submitCompletedTask(completeTaskForm)">
      <div class="modal-header">
        <h5 class="modal-title">Complete Task</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" *ngIf="selectedTask">
        
        <!-- Task Title -->
        <div class="mb-3">
          <label class="form-label">Task</label>
          <input type="text" class="form-select" [value]="selectedTask.title" readonly>
        </div>

        <!-- Completion Notes -->
        <div class="mb-3">
          <label class="form-label">Completion Notes</label>
          <textarea class="form-select" rows="3" placeholder="Enter details about task completion"
            [(ngModel)]="selectedTask.completionNotes" name="completionNotes"></textarea>
        </div>

        <!-- Outcome -->
        <div class="mb-3">
          <label class="form-label">Outcome</label>
          <select class="form-select" [(ngModel)]="selectedTask.outcome" name="outcome" required>
            <option value="">Select outcome</option>
            <option value="positive">Positive - Deal progressed</option>
            <option value="neutral">Neutral - No change</option>
            <option value="negative">Negative - Setback</option>
            <option value="scheduled">Follow-up scheduled</option>
            <option value="lost">Opportunity lost</option>
          </select>
        </div>

        <!-- Hours Spent -->
        <div class="mb-3">
          <label class="form-label">Hours Spent</label>
          <select class="form-select" [(ngModel)]="selectedTask.hoursSpent" name="hoursSpent">
            <option [ngValue]="0">0 hours</option>
            <option [ngValue]="0.25">15 minutes</option>
            <option [ngValue]="0.5">30 minutes</option>
            <option [ngValue]="0.75">45 minutes</option>
            <option [ngValue]="1">1 hour</option>
            <option [ngValue]="1.5">1.5 hours</option>
            <option [ngValue]="2">2 hours</option>
            <option [ngValue]="3">3 hours</option>
            <option [ngValue]="4">4 hours</option>
          </select>
        </div>

        <!-- Follow-up Task Checkbox -->
        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="createFollowup"
            [(ngModel)]="selectedTask.followupCreated" name="followupCreated">
          <label class="form-check-label" for="createFollowup">Create follow-up task</label>
        </div>

        <!-- Follow-up Fields -->
        <div *ngIf="selectedTask.followupCreated" class="ps-3 border-start border-2 border-secondary">
          <div class="mb-3">
            <label class="form-label">Follow-up Task</label>
            <input type="text" class="form-select" placeholder="Enter follow-up task description"
              [(ngModel)]="selectedTask.followupTask" name="followupTask">
          </div>
     <div class="mb-3" style="position: relative;">
  <label class="form-label">Due Date</label>
  <input type="date" class="form-select" [(ngModel)]="selectedTask.followupDueDate" name="followupDueDate">
</div>

          <div class="mb-3">
            <label class="form-label">Priority</label>
            <select class="form-select" [(ngModel)]="selectedTask.followupPriority" name="followupPriority">
              <option value="normal">Normal</option>
              <option value="high">High</option>
              <option value="urgent">Urgent</option>
            </select>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary rounded-pill" data-bs-dismiss="modal">Cancel</button>
        <button type="submit" class="btn btn-success rounded-pill">
          <i class="fas fa-check me-2"></i> Complete Task
        </button>
      </div>
    </form>
  </div>
</div>





          <!-- Bootstrap Modal for Carrier Contact -->
          <div class="modal fade" id="contactModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-md"> <!-- custom size -->
              <div class="modal-content rounded-3 shadow">

                <!-- Header -->
                <div class="modal-header">
                  <h5 class="modal-title fw-bold">
                    {{ editingContactId ? 'Edit Carrier Contact' : 'Add New Carrier Contact' }}
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Body -->
                <div class="modal-body">
                  <form #contactForm="ngForm" (ngSubmit)="onContactFormSubmit(contactForm)">

                    <!-- Full Name -->
                    <div class="mb-3">
                      <label for="fullName" class="form-label">Full Name <span class="text-danger">*</span></label>
                      <input type="text" class="form-select" id="fullName" [(ngModel)]="newContact.fullName"
                        name="fullName" placeholder="Enter full name" required />
                    </div>

                    <!-- Phone -->
                    <div class="mb-3">
                      <label for="phone" class="form-label">Phone</label>
                      <input type="text" class="form-select" id="phone" [(ngModel)]="newContact.phone" name="phone"
                        placeholder="Enter phone number" />
                    </div>

                    <!-- Ext -->
                    <div class="mb-3">
                      <label for="ext" class="form-label">Ext</label>
                      <input type="text" class="form-select" id="ext" [(ngModel)]="newContact.ext" name="ext"
                        placeholder="Enter extension" />
                    </div>

                    <!-- Mobile -->
                    <div class="mb-3">
                      <label for="mobile" class="form-label">Mobile</label>
                      <input type="text" class="form-select" id="mobile" [(ngModel)]="newContact.mobile" name="mobile"
                        placeholder="Enter mobile number" />
                    </div>

                    <!-- Email -->
                    <div class="mb-3">
                      <label for="email" class="form-label">Email</label>
                      <input type="email" class="form-select" id="email" [(ngModel)]="newContact.email" name="email"
                        placeholder="Enter email address" />
                    </div>

                    <!-- Job Title -->
                    <div class="mb-3">
                      <label for="jobTitle" class="form-label">Job Title</label>
                      <input type="text" class="form-select" id="jobTitle" [(ngModel)]="newContact.jobTitle"
                        name="jobTitle" placeholder="Enter job title" />
                    </div>

                    <!-- Footer -->
                    <div class="modal-footer d-flex justify-content-end">
                      <button type="button" class="btn btn-secondary px-3" data-bs-dismiss="modal">Cancel</button>
                      <button data-bs-dismiss="modal" type="submit" class="btn btn-primary px-3">
                        <i class="fas me-1" [ngClass]="editingContactId ? 'fa-save' : 'fa-plus'"></i>
                        {{ editingContactId ? 'Update Contact' : 'Add Contact' }}
                      </button>
                    </div>

                  </form>
                </div>
              </div>
            </div>
          </div>




          <!-- Tab Content -->
          <div class="tab-content">

            <!-- Activity Tab -->
            <div class="tab-pane fade show active" id="activity" role="tabpanel">
              <div class="card mb-4">
                <div class="card-body">
                  <h5 class="card-title">Log New Activity</h5>
                  <ul class="nav mb-3" id="actionTabs">
                    <li *ngFor="let type of activityTypes" class="nav-item me-2">
                      <button class="btn nav-link border" [ngClass]="{'active': selectedActivityType === type.value}"
                        type="button" (click)="onActivityTypeChange(type.value)">
                        <i class="fas" [ngClass]="type.icon + ' me-2'"></i>{{ type.label }}
                      </button>
                    </li>
                  </ul>

                  <div *ngIf="selectedActivityType !== 'all'">
                    <div class="mb-3">
                      <label class="form-label">Details</label>
                      <textarea class="form-select" rows="3" [(ngModel)]="activityForm.details" name="details"
                        placeholder="Enter activity details"></textarea>
                    </div>
                    <div class="mb-3" *ngIf="selectedActivityType !== 'text' && selectedActivityType !== 'note'">
                      <label class="form-label">Outcome</label>
                      <select class="form-select" [(ngModel)]="activityForm.outcome" name="outcome">
                        <option value="">Select outcome</option>
                        <option value="positive">Positive</option>
                        <option value="neutral">Neutral</option>
                        <option value="negative">Negative</option>
                        <option value="followup">Requires Follow-up</option>
                      </select>
                    </div>
                  </div>

                  <!-- Buttons hide when 'all' is selected -->
                  <div class="d-flex justify-content-end" *ngIf="selectedActivityType !== 'all'">
                    <button class="btn btn-outline-secondary me-2 rounded-pill" type="button"
                      (click)="activityForm.details='';activityForm.outcome=''">
                      Cancel
                    </button>
                    <button class="btn btn-success rounded-pill" type="button" (click)="logActivity()"
                      [disabled]="isLoadingActivity">
                      Log Activity
                    </button>
                  </div>
                </div>
              </div>

              <h5 class="mb-3">Recent Activity</h5>
              <div *ngIf="filteredActivityLogs.length === 0" class="text-muted">No activity yet.</div>
              <div *ngFor="let log of filteredActivityLogs; let i = index; trackBy: trackByLogId" class="card mb-2">
                <div class="card-body d-flex">
                  <div class="rounded-circle p-2 me-3" [ngClass]="{
                'text-primary': log.type === 'call',
                'text-danger': log.type === 'email',
                'text-info': log.type === 'text' || log.type === 'meeting' || log.type === 'note'
              }">
                    <i class="fas" [ngClass]="{
                  'fa-phone': log.type === 'call',
                  'fa-envelope': log.type === 'email',
                  'fa-sms': log.type === 'text',
                  'fa-calendar-alt': log.type === 'meeting',
                  'fa-sticky-note': log.type === 'note'
                }"></i>
                  </div>
                  <div class="flex-grow-1">
                    <small class="text-muted">{{ log.createdAt | date:'medium' }}</small>
                    <p class="mb-2">{{ log.details }}</p>
                    <div class="d-flex align-items-center" *ngIf="selectedCrm?.carrierName">
                      <small class="text-muted">{{ selectedCrm.carrierName }}</small>
                    </div>
                    <div class="small text-muted mt-1">
                      <i class="fas fa-user me-1"></i> Created by {{ log.createdByName || 'Unknown User' }}
                      <span *ngIf="log.createdAt">on {{ log.createdAt | date:'MMM d, y, h:mm a' }}</span>
                    </div>
                    <span class="badge bg-secondary" *ngIf="log.outcome">
                      {{ log.outcome === 'followup' ? 'Requires Follow-up' : (log.outcome | titlecase) }}
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Tasks Tab -->
            <div class="tab-pane fade" id="tasks" role="tabpanel">
              <ul class="nav nav-tabs mb-3">
                <li class="nav-item">
                  <a class="nav-link" [class.active]="selectedTab === 'active'" (click)="selectedTab = 'active'">Active
                    ({{ activeTasks.length }})</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" [class.active]="selectedTab === 'completed'"
                    (click)="selectedTab = 'completed'">Completed ({{ completedTasks.length }})</a>
                </li>
              </ul>

              <div class="tab-content">
                <!-- Active Tasks -->
                <div class="tab-pane fade show active" *ngIf="selectedTab === 'active'">
                  <div *ngFor="let task of activeTasksSorted" class="card mb-3 shadow-sm border-0 rounded-3">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h6 class="mb-0" [ngClass]="{ 'text-decoration-line-through': task.completed }"
    (click)="openTaskDetails(task)" style="cursor:pointer;">
  {{ task.title }}
</h6>
                        <button class="btn btn-sm btn-outline-success" (click)="openTaskModal(task)"
                          [disabled]="task.completed"><i class="fas fa-check"></i></button>
                      </div>
                      
                      <div class="small text-muted border-top pt-2"><i class="fas fa-user me-1"></i> Created by {{
                        task.createdBy || 'Unknown' }}
                        <span *ngIf="task.createdAt">on {{ task.createdAt | date:'MMM d, y, h:mm a' }}</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Completed Tasks -->
                <div class="tab-pane fade show active" *ngIf="selectedTab === 'completed'">
                  <div *ngIf="completedTasks.length === 0" class="text-center text-muted py-4">
                    <i class="fas fa-check-circle fa-2x mb-2"></i>
                    <div>No completed tasks.</div>
                  </div>
                  <div *ngFor="let task of completedTasksSorted" class="card mb-3 shadow-sm border-0 rounded-3">
                    <div class="card-body">
                      <p class="small text-muted mb-2" *ngIf="task.description"><i class="fas fa-align-left me-1"></i>{{
                        task.description }}</p>
                      <div class="row text-muted small mb-2 ps-1">
                        <div class="col-md-4 mb-1"><i class="fas fa-clock me-1"></i> {{ getDueLabel(task.dueDate) }}
                        </div>
                        <div class="col-md-4 mb-1" *ngIf="task.carrierContact"><i class="fas fa-phone me-1"></i> {{
                          task.carrierContact }}</div>
                        <div class="col-md-4 mb-1"><i class="fas fa-flag me-1"></i><span class="badge bg-secondary">{{
                            task.priority | titlecase }}</span></div>
                      </div>
                      <div class="text-success small border-top pt-2"><i class="fas fa-check-circle me-1"></i> Completed
                        by {{ task.completedBy || 'Unknown' }}
                        <span *ngIf="task.completedAt">on {{ task.completedAt | date:'MMM d, y, h:mm a' }}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Services Tab -->
            <div class="tab-pane fade" id="services" role="tabpanel">
              <div class="row g-3">
                <div class="col-md-4">
                  <div class="card border-success h-100">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="bg-success text-white rounded p-2">
                          <i class="fas fa-clipboard-check"></i>
                        </div>
                        <span class="badge bg-success">Active</span>
                      </div>
                      <h5 class="card-title">Compliance Services</h5>
                      <p class="card-text small text-muted">
                        FMCSA compliance, safety audits, and DOT compliance management.
                      </p>
                      <div class="d-flex justify-content-between small text-muted">
                        <span>Since: Jun 2023</span>
                        <span>$1,250/mo</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="card h-100">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="bg-primary text-white rounded p-2">
                          <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <span class="badge bg-danger">Not Sold</span>
                      </div>
                      <h5 class="card-title">ELD Solutions</h5>
                      <p class="card-text small text-muted">
                        Electronic logging devices with fleet management dashboard.
                      </p>
                      <div class="d-flex justify-content-between small text-muted">
                        <span>Potential: $3,500/mo</span>
                        <button class="btn btn-outline-primary btn-sm">
                          Pitch Now
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="card h-100">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="bg-warning text-white rounded p-2">
                          <i class="fas fa-map-marked-alt"></i>
                        </div>
                        <span class="badge bg-danger">Not Sold</span>
                      </div>
                      <h5 class="card-title">TMS Platform</h5>
                      <p class="card-text small text-muted">
                        Transportation management system with dispatch tools.
                      </p>
                      <div class="d-flex justify-content-between small text-muted">
                        <span>Potential: $2,800/mo</span>
                        <button class="btn btn-outline-primary btn-sm">
                          Pitch Now
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="card h-100">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="bg-danger text-white rounded p-2">
                          <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <span class="badge bg-danger">Not Sold</span>
                      </div>
                      <h5 class="card-title">Factoring Services</h5>
                      <p class="card-text small text-muted">
                        Quick pay and invoice factoring with competitive rates.
                      </p>
                      <div class="d-flex justify-content-between small text-muted">
                        <span>Potential: 2% of invoices</span>
                        <button class="btn btn-outline-primary btn-sm">
                          Pitch Now
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-md-4">
                  <div class="card h-100">
                    <div class="card-body">
                      <div class="d-flex justify-content-between align-items-start mb-3">
                        <div class="bg-purple text-white rounded p-2">
                          <i class="fas fa-gas-pump"></i>
                        </div>
                        <span class="badge bg-danger">Not Sold</span>
                      </div>
                      <h5 class="card-title">Fuel Cards</h5>
                      <p class="card-text small text-muted">
                        Discount fuel programs with nationwide coverage.
                      </p>
                      <div class="d-flex justify-content-between small text-muted">
                        <span>Potential: $0.10/gal savings</span>
                        <button class="btn btn-outline-primary btn-sm">
                          Pitch Now
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Notes Tab -->
            <div class="tab-pane fade" id="notes" role="tabpanel">
              <form style=" margin-left:-15px; " #noteForm="ngForm" (ngSubmit)="submitNote(noteForm)">
                <div class="mb-2 ">
                  <textarea [(ngModel)]="newNote" name="note" class="form-control" rows="5"
                    placeholder="Write a new note..." (input)="autoResize($event)" style="min-height: 150px;" required>
                   </textarea>
                </div>

                <!-- Dynamic button: Add or Update -->
                <button type="submit" class="btn btn-success  mb-3 ml-3 " *ngIf="!editingNoteId">
                  Add Note
                </button>
                <button type="button" class="btn btn-success mb-3 ml-3" (click)="updateNote(noteForm)"
                  *ngIf="editingNoteId">
                  Update Note
                </button>

              </form>

              <ul class="list-group" *ngIf="notes.length > 0">
                <li class="list-group-item" *ngFor="let note of notes.slice().reverse()"
                  [hidden]="note.companyId !== (selectedCrm?.companyId || selectedCrm?._id)">

                  <div class="d-flex justify-content-between align-items-start">
                    <span style="white-space: pre-wrap;">{{ note.note }}</span>
                    <div>
                      <button class="btn btn-sm btn-outline-secondary me-2" (click)="editNote(note._id)"><i
                          class="fas fa-edit"></i></button>
                      <button class="btn btn-sm btn-danger" (click)="deleteNote(note._id)"><i
                          class="fas fa-trash"></i></button>
                    </div>
                  </div>
                  <div class="small text-muted mt-1">
                    <i class="fas fa-user me-1"></i> Created by {{ note.createdByName || 'Unknown User' }}
                    <span *ngIf="note.createdAt">on {{ note.createdAt | date:'MMM d, y, h:mm a' }}</span>
                  </div>
                </li>
              </ul>
              <p *ngIf="notes.length === 0" class="text-muted">No notes added yet.</p>
            </div>

            <!-- Carrier Profile Tab -->
            <div class="tab-pane fade" id="c-profile" role="tabpanel">
              <div *ngIf="selectedCrm" class="d-flex align-items-center mt-4">
                <div class="bg-light rounded p-3 me-3">
                  <h3 class="mb-0">{{ selectedCrm.carrierName.charAt(0) }}{{ selectedCrm.carrierName.split('
                    ')[1]?.charAt(0) || '' }}</h3>
                </div>
                <div>
                  <h3 class="mb-1">{{ selectedCrm.carrierName }}</h3>
                  <div class="d-flex align-items-center mb-2">
                    <span class="badge bg-warning text-dark me-3">{{ selectedCrm.status }}</span>
                    <span class="text-muted small">MC# {{ selectedCrm.mc }}</span>
                  </div>
                  <div class="mb-1"><i class="fas fa-user me-2 text-muted"></i>{{ selectedCrm.legalName }} ({{
                    selectedCrm.title }})</div>
                  <div class="mb-1"><i class="fas fa-phone me-2 text-muted"></i>{{ selectedCrm.phoneNumber }}</div>
                  <div><i class="fas fa-envelope me-2 text-muted"></i>{{ selectedCrm.companyEmail }}</div>
                </div>
              </div>
            </div>




            <!-- Carrier Contacts Tab -->
            <div class="tab-pane fade" id="c-contact" role="tabpanel">
              <div class="table-responsive">
                <table class="table table-bordered">
                  <thead>
                    <tr>
                      <th>Full Name</th>
                      <th>Phone</th>
                      <th>Ext</th>
                      <th>Mobile</th>
                      <th>Email</th>
                      <th>Job Title</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let contact of carrierContacts"
                      [hidden]="contact.companyId !== (selectedCrm?.companyId || selectedCrm?._id)">
                      <td>{{ contact.fullName }}</td>
                      <td>{{ contact.phone }}</td>
                      <td>{{ contact.ext }}</td>
                      <td>{{ contact.mobile }}</td>
                      <td>{{ contact.email }}</td>
                      <td>{{ contact.jobTitle }}</td>
                      <td>
                        <button class="btn btn-sm btn-outline-secondary me-1" (click)="editContact(contact)"><i
                            class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger" (click)="deleteCarrierContact(contact._id)"><i
                            class="fas fa-trash"></i></button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

          </div>

          <!-- Footer Buttons -->
          <hr>
          <!-- <div class="modal-footer mt-3 pb-3">
            <button class="btn btn-outline-secondary me-2 rounded-pill"><i class="fas fa-file-pdf me-2"></i>
              Export</button>
            <button class="btn btn-success rounded-pill"><i class="fas fa-save me-2"></i> Save Changes</button>
          </div> -->

        </div>



        <!-- ======= Footer ======= -->

        <footer id="footer" class="footer"
          style="background-color: #c1c1c1; width: 100vw; margin-bottom: -25px; margin-left: -200px;">
          <div class="text-dark text-center">
            <span class="text-muted fw-semibold me-1">2025Â© all rights reserved</span>
            <a class="font-weight-700 text-hover-dark text-dark text-uppercase">3PL TEK INC.</a>
          </div>
        </footer>


        <!-- End Footer -->

        
<div class="modal fade" id="taskDetailsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" style="max-width:800px;">
    <div class="modal-content shadow rounded-3">
      <div class="modal-header bg-light border-bottom">
        <h5 class="modal-title">
          <i class="fas fa-tasks text-success me-2"></i> Task Details
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" *ngIf="selectedTask">
        <div class="mb-3">
          <h4 class="mb-1 text-primary">
            <i class="fas fa-clipboard-list me-2"></i> {{ selectedTask.title }}
          </h4>
          <span class="badge bg-secondary ms-2">{{ selectedTask.priority | titlecase }}</span>
          <span class="badge  ms-2" [ngClass]="{
            'bg-success': selectedTask.completed,
            'bg-warning text-dark': !selectedTask.completed
          }">
            {{ selectedTask.completed ? 'Completed' : 'Active' }}
          </span>
        </div>
        <hr>
        <div class="row mb-2">
          <div class="col-12 mb-2">
            <i class="fas fa-align-left me-2 text-muted"></i>
            <strong>Description:</strong>
            <span class="text-muted">{{ selectedTask.description || 'No description' }}</span>
          </div>
          <div class="col-6 mb-2">
            <i class="fas fa-calendar-alt me-2 text-muted"></i>
            <strong>Due Date:</strong>
            <span class="text-muted">{{ selectedTask.dueDate | date:'MMM d, y' }}</span>
          </div>
          <div class="col-6 mb-2" *ngIf="selectedTask.carrierContact">
            <i class="fas fa-phone me-2 text-muted"></i>
            <strong>Carrier Contact:</strong>
            <span class="text-muted">{{ selectedTask.carrierContact }}</span>
          </div>
          <div class="col-6 mb-2" *ngIf="selectedTask.assignedTo">
            <i class="fas fa-user-check me-2 text-muted"></i>
            <strong>Assigned To:</strong>
            <span class="text-muted">{{ selectedTask.assignedTo }}</span>
          </div>
          <div class="col-6 mb-2" *ngIf="selectedTask.relatedTo">
            <i class="fas fa-link me-2 text-muted"></i>
            <strong>Related To:</strong>
            <span class="text-muted">{{ selectedTask.relatedTo | titlecase }}</span>
          </div>
        </div>
        <hr>
        <div class="row mb-2">
          <div class="col-6 mb-2">
            <i class="fas fa-user me-2 text-muted"></i>
            <strong>Created By:</strong>
            <span class="text-muted">{{ selectedTask.createdBy }}</span>
          </div>
          <div class="col-6 mb-2">
            <i class="fas fa-clock me-2 text-muted"></i>
            <strong>Created At:</strong>
            <span class="text-muted">{{ selectedTask.createdAt | date:'MMM d, y, h:mm a' }}</span>
          </div>
          <div class="col-6 mb-2" *ngIf="selectedTask.completed">
            <i class="fas fa-user-check me-2 text-success"></i>
            <strong>Completed By:</strong>
            <span class="text-muted">{{ selectedTask.completedBy }}</span>
          </div>
          <div class="col-6 mb-2" *ngIf="selectedTask.completed">
            <i class="fas fa-check-circle me-2 text-success"></i>
            <strong>Completed At:</strong>
            <span class="text-muted">{{ selectedTask.completedAt | date:'MMM d, y, h:mm a' }}</span>
          </div>
        </div>
        <div class="mb-2" *ngIf="selectedTask.outcome">
          <i class="fas fa-flag-checkered me-2 text-info"></i>
          <strong>Outcome:</strong>
          <span class="badge bg-info">{{ selectedTask.outcome | titlecase }}</span>
        </div>
        <div class="mb-2" *ngIf="selectedTask.hoursSpent">
          <i class="fas fa-hourglass-half me-2 text-muted"></i>
          <strong>Hours Spent:</strong>
          <span class="text-muted">{{ selectedTask.hoursSpent }} hrs</span>
        </div>
        <div class="mb-2" *ngIf="selectedTask.completionNotes">
          <i class="fas fa-sticky-note me-2 text-warning"></i>
          <strong>Completion Notes:</strong>
          <span class="text-muted">{{ selectedTask.completionNotes }}</span>
        </div>
        <div class="mb-2" *ngIf="selectedTask.followupCreated">
          <i class="fas fa-redo me-2 text-primary"></i>
          <strong>Follow-up Created:</strong>
          <span class="text-muted">{{ selectedTask.followupTask }}</span>
          <span *ngIf="selectedTask.followupDueDate"> | Due: {{ selectedTask.followupDueDate | date:'MMM d, y' }}</span>
          <span *ngIf="selectedTask.followupPriority"> | Priority: <span class="badge bg-secondary">{{ selectedTask.followupPriority | titlecase }}</span></span>
        </div>
      </div>
    </div>
  </div>
</div>









        <div class="offcanvas offcanvas-end" tabindex="-1" id="addLocation" aria-labelledby="offcanvasRightLabel"
          style="width: 80%;" data-bs-backdrop="static">

          <div class="modal-header" style="padding: 15px; border-bottom: 1px solid #ccc;">

            <h5 class="modal-title font-weight-500" style="font-size: 26px;  color:rgb(53, 53, 53)  ">Edit Company</h5>

            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>

          </div>


          <div class="offcanvas-body view-load position-relative">
            <form class="row g-3" (ngSubmit)="updateCompanyProfile()">
              <div class="sidebar_ac">
                <h4 class="px-2 font-weight-600 mb-4">Company Form</h4>

                <ul>
                  <li [ngClass]="{'active-option': activeSection === 'company-info'}">
                    <a href="#company-info" class="toggle-section"
                      (click)="goToSection('company-info',$event); $event.preventDefault();">
                      Company Information
                    </a>
                  </li>

                  <li [ngClass]="{'active-option': activeSection === 'insurance-info'}">
                    <a href="#insurance-info" class="toggle-section"
                      (click)="goToSection('insurance-info',$event); $event.preventDefault();">
                      Insurance Information
                    </a>
                  </li>
                  <li [ngClass]="{'active-option': activeSection === 'compliance-info'}">
                    <a href="#compliance-info" class="toggle-section"
                      (click)="goToSection('compliance-info',$event); $event.preventDefault();">
                      Compaliance Documentation
                    </a>
                  </li>


                </ul>
              </div>

              <div class="content_ac" *ngIf="activeSection === 'company-info'">
                <h3 class="mb-4">Company Information</h3>
                <form class="row g-3" (ngSubmit)="updateCompanyProfile()">
                  <div class="row">
                    <div class="col-md-6">
                      <label class="mb-2 d-block" for="dotNumber">DOT Number:</label>
                      <input type="text" class="form-control" id="dot" [(ngModel)]="companyToEdit['dot']" name="DOT"
                        required (ngModelChange)="onDotChange($event)">
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">CA Number:</label>
                      <input type="text" class="form-control" id="caNumber" [(ngModel)]="companyToEdit['caNumber']"
                        name="caNumber" #caNumber="ngModel" required>
                    </div>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">Company Name DBA</label>
                      <input type="text" class="form-control" id="CompanyDBA" placeholder="CompanyDBA"
                        [(ngModel)]="companyToEdit['CompanyDBA']" name="CompanyDBA" #CompanyDBA="ngModel" required>
                    </div>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">Corporation</label>
                      <input type="text" class="form-control" id="corporation"
                        [(ngModel)]="companyToEdit['corporation']" name="corporation" #corporation="ngModel" required>
                    </div>
                    <hr>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">KYU</label>
                      <input type="text" class="form-control" id="kyu" placeholder="KYU"
                        [(ngModel)]="companyToEdit['kyu']" name="KYU" #kyu="ngModel" required>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="kyuUploadDocument">Upload Document</label>
                        <input type="file" class="form-control" id="kyuUploadDocument"
                          (change)="companyEditFile($event, 'kyuUploadDocument')">

                        <!-- Display the selected file name -->
                        <small *ngIf="companyFileNames['kyuUploadDocument']">
                          Selected: {{ companyFileNames['kyuUploadDocument'] }}
                        </small>
                      </div>
                    </div>


                    <div class="col-md-6">
                      <label class="mb-2 d-block">KYU Expiration:</label>
                      <input type="text" class="form-control" id="kyu" placeholder="KYU"
                        [(ngModel)]="companyToEdit['kyuExpiration']" name="kyuExpiration" #kyuExpiration="ngModel"
                        required>
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">NY:</label>
                      <input type="text" class="form-control" id="ny" placeholder="ny" [(ngModel)]="companyToEdit['ny']"
                        name="ny" #ny="ngModel" required>
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">NY Expiration:</label>
                      <input type="text" class="form-control" id="nyExpiration" placeholder="nyExpiration"
                        [(ngModel)]="companyToEdit['nyExpiration']" name="nyExpiration" #nyExpiration="ngModel"
                        required>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="nyUploadDocument">Upload Document</label>
                        <input type="file" class="form-control" id="nyUploadDocument"
                          (change)="companyEditFile($event, 'nyUploadDocument')">
                        <small *ngIf="companyFileNames['nyUploadDocument']">
                          Selected: {{ companyFileNames['nyUploadDocument'] }}
                        </small>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">Ein</label>
                      <input type="text" class="form-control" id="ein" placeholder="ein"
                        [(ngModel)]="companyToEdit['ein']" name="ein" #ein="ngModel" required>
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">w9</label>
                      <input type="text" class="form-control" id="w9" placeholder="KYU"
                        [(ngModel)]="companyToEdit['w9']" name="w9" #w9="ngModel" required>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="w9UploadDocument">Upload Document</label>
                        <input type="file" class="form-control" id="w9UploadDocument"
                          (change)="companyEditFile($event, 'w9UploadDocument')">
                        <small *ngIf="companyFileNames['w9UploadDocument']">
                          Selected: {{ companyFileNames['w9UploadDocument'] }}
                        </small>
                      </div>
                    </div>
                    <hr>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">IFTA ACC:</label>
                      <input type="text" class="form-control" id="iftaAcc" placeholder="iftaAcc"
                        [(ngModel)]="companyToEdit['iftaAcc']" name="iftaAcc" #iftaAcc="ngModel" required>
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">prepass:</label>
                      <input type="text" class="form-control" id="prepass" placeholder="prepass"
                        [(ngModel)]="companyToEdit['prepass']" name="prepass" #prepass="ngModel" required>
                    </div>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">IRP ACC:</label>
                      <input type="text" class="form-control" id="irpAcc" placeholder="irpAcc"
                        [(ngModel)]="companyToEdit['irpAcc']" name="irpAcc" #irpAcc="ngModel" required>
                    </div>



                    <div class="col-md-6">
                      <label class="mb-2 d-block">IRP Renewal Date:</label>
                      <input type="text" class="form-control" id="irpRenewalDate" placeholder="irpRenewalDate"
                        [(ngModel)]="companyToEdit['irpRenewalDate']" name="irpRenewalDate" #irpRenewalDate="ngModel"
                        required>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="insuranceDocument">Insurance Document</label>
                        <input type="file" class="form-control" id="insuranceDocument"
                          (change)="companyEditFile($event, 'insuranceDocument')">
                        <small *ngIf="companyFileNames['insuranceDocument']">
                          Selected: {{ companyFileNames['insuranceDocument'] }}
                        </small>

                      </div>
                    </div>
                  </div>
                  <hr>

                  <div class="row">

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="companyName">Company Name:</label>
                        <input type="text" class="form-control" id="companyName" name="companyName"
                          [(ngModel)]="companyToEdit['companyName']" #companyName="ngModel" required>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="companyType">Company Type:</label>
                        <select id="companyType" class="form-select form-control" name="companyType"
                          [(ngModel)]="companyToEdit['companyType']" #companyType="ngModel" required>
                          <option value="" disabled selected>Select Company Type</option>
                          <option value="Carrier">Carrier</option>
                          <option value="Broker">Broker</option>
                          <option value="Freight Forwarder">Freight Forwarder</option>
                          <option value="Other">Other</option>
                        </select>

                      </div>
                    </div>



                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="mc">MC Number:</label>
                        <input type="text" class="form-control" id="mc" name="mc" [(ngModel)]="companyToEdit['mc']"
                          #mc="ngModel" required>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="operatingAuthority">Operating Authority:</label>
                        <select id="operatingAuthority" class="form-control form-select" name="operatingAuthority"
                          [(ngModel)]="companyToEdit['operatingAuthority']" #operatingAuthority="ngModel" required
                          [ngClass]="{'is-invalid': operatingAuthority.invalid && (operatingAuthority.dirty || operatingAuthority.touched)}">
                          <option value="" disabled selected>Select Operating Authority</option>
                          <option value="Interstate">Interstate</option>
                          <option value="Intrastate">Intrastate</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="row">

                    <h3 class="mb-4 d-block" style="font-size: 32px;  color:rgb(53, 53, 53) ">Company Address</h3>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="phyStreet">Company Address (Street):</label>
                        <input type="text" class="form-control" id="phyStreet" name="phyStreet"
                          [(ngModel)]="companyToEdit['phyStreet']" #phyStreet="ngModel" required>

                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="phyCity">Company Address (City):</label>
                        <input type="text" class="form-control" id="phyCity" name="phyCity"
                          [(ngModel)]="companyToEdit['phyCity']" #phyCity="ngModel" required>

                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="phyState">Company Address (State):</label>
                        <select class="form-control" id="phyState" name="phyState"
                          [(ngModel)]="companyToEdit['phyState']" #phyState="ngModel" required>
                          <option value="" hidden>Select State</option>
                          <option value="AL">Alabama</option>
                          <option value="AK">Alaska</option>
                          <option value="AZ">Arizona</option>
                          <option value="AR">Arkansas</option>
                          <option value="CA">California</option>
                          <option value="CO">Colorado</option>
                          <option value="CT">Connecticut</option>
                          <option value="DE">Delaware</option>
                          <option value="FL">Florida</option>
                          <option value="GA">Georgia</option>
                          <option value="HI">Hawaii</option>
                          <option value="ID">Idaho</option>
                          <option value="IL">Illinois</option>
                          <option value="IN">Indiana</option>
                          <option value="IA">Iowa</option>
                          <option value="KS">Kansas</option>
                          <option value="KY">Kentucky</option>
                          <option value="LA">Louisiana</option>
                          <option value="ME">Maine</option>
                          <option value="MD">Maryland</option>
                          <option value="MA">Massachusetts</option>
                          <option value="MI">Michigan</option>
                          <option value="MN">Minnesota</option>
                          <option value="MS">Mississippi</option>
                          <option value="MO">Missouri</option>
                          <option value="MT">Montana</option>
                          <option value="NE">Nebraska</option>
                          <option value="NV">Nevada</option>
                          <option value="NH">New Hampshire</option>
                          <option value="NJ">New Jersey</option>
                          <option value="NM">New Mexico</option>
                          <option value="NY">New York</option>
                          <option value="NC">North Carolina</option>
                          <option value="ND">North Dakota</option>
                          <option value="OH">Ohio</option>
                          <option value="OK">Oklahoma</option>
                          <option value="OR">Oregon</option>
                          <option value="PA">Pennsylvania</option>
                          <option value="RI">Rhode Island</option>
                          <option value="SC">South Carolina</option>
                          <option value="SD">South Dakota</option>
                          <option value="TN">Tennessee</option>
                          <option value="TX">Texas</option>
                          <option value="UT">Utah</option>
                          <option value="VT">Vermont</option>
                          <option value="VA">Virginia</option>
                          <option value="WA">Washington</option>
                          <option value="WV">West Virginia</option>
                          <option value="WI">Wisconsin</option>
                          <option value="WY">Wyoming</option>
                        </select>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="phyZipcode">Company Address (Zip):</label>
                        <input type="text" class="form-control" id="phyZipcode" name="phyZipcode"
                          [(ngModel)]="companyToEdit['phyZipcode']" #phyZipcode="ngModel" required
                          pattern="^[0-9]{5}(-[0-9]{4})?$">
                      </div>
                    </div>



                    <div class="col-md-6">
                      <h5 class="font-14 d-block font-weight-700">Phone Number</h5>
                      <input type="text" class="form-control" id="phoneNumber" placeholder="phoneNumber"
                        [(ngModel)]="companyToEdit['phoneNumber']" name="phoneNumber" #phoneNumber="ngModel">
                    </div>



                    <div class="col-md-6">
                      <h5 class="font-14 d-block font-weight-700">Company Email</h5>
                      <input type="text" class="form-control" id="companyEmail" placeholder="companyEmail"
                        [(ngModel)]="companyToEdit['companyEmail']" name="companyEmail" #companyEmail="ngModel"
                        required>
                    </div>
                  </div>
                </form>
                <div class="modal-footer justify-content-center"
                  style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px; ">
                  <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
                    data-bs-dismiss="offcanvas" aria-label="Close"> Close</button>
                  <button type="submit" class="btn btn-success btn-sm text-uppercase rounded-pill"
                    data-bs-dismiss="offcanvas">Save changes</button>
                  <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
                    (click)="goToSection('insurance-info',$event)">Next</button>
                </div>
              </div>



              <div class="content_ac" *ngIf="activeSection === 'insurance-info'">

                <h3 class="mb-4">Insurance Information</h3>

                <form class="row g-3" (ngSubmit)="updateCompanyProfile()">
                  <div class="row">


                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="insuranceBrokerName">Insurance Broker Name</label>
                        <input type="text" class="form-control" id="insuranceBrokerName" name="insuranceBrokerName"
                          [(ngModel)]="companyToEdit['insuranceBrokerName']" #insuranceBrokerName="ngModel" required>

                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="companyPhysicalAddress">Company Physical Address</label>
                        <input type="text" class="form-control" id="companyPhysicalAddress"
                          name="companyPhysicalAddress" [(ngModel)]="companyToEdit['companyPhysicalAddress']"
                          #companyPhysicalAddress="ngModel" required>

                      </div>
                    </div>


                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="companyMailingAddress">Company Mailing Address:</label>
                        <input type="text" class="form-control" id="companyMailingAddress" name="companyMailingAddress"
                          [(ngModel)]="companyToEdit['companyMailingAddress']" #companyMailingAddress="ngModel"
                          required>

                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="companyEmailAddress">Company Email Address:</label>
                        <input type="text" class="form-control" id="companyEmailAddress" name="companyEmailAddress"
                          [(ngModel)]="companyToEdit['companyEmailAddress']" #companyEmailAddress="ngModel" required>

                      </div>
                    </div>

                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="Contact">Contact Number:</label>
                        <input type="text" class="form-control" id="Contact" name="Contact"
                          [(ngModel)]="companyToEdit['Contact']" #Contact="ngModel" required>

                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-md-12">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="insuranceType">Insurance Type</label>
                        <select id="dropdowns" class="form-control form-select"
                          [(ngModel)]="companyToEdit['insuranceType']" name="insuranceType" required>
                          <option value="" selected>Select an option</option>
                          <option value="Auto Liability Insurance">Auto Liability Insurance</option>
                          <option value="General Liability Insurance">General Liability Insurance</option>
                          <option value="Physical Damage Insurance">Physical Damage Insurance</option>
                          <option value="Cargo Insurance">Cargo Insurance</option>
                          <option value="Trailer Interchange Insurance">Trailer Interchange Insurance</option>
                          <option value="Workersâ Compensation Insurance">Workersâ Compensation Insurance</option>
                          <option value="Umbrella Insurance">Umbrella Insurance</option>
                        </select>
                      </div>

                      <div *ngIf="companyToEdit['insuranceType']" class="border bg-light rounded">
                        <div class="modal-header border-bottom p-3">
                          <h5 class="modal-title">{{ companyToEdit['insuranceType'] }}</h5>
                          <div>
                            <!-- <a routerLink="/Drivers/View" class="font-14 text-uppercase font-weight-500 me-3">View</a> -->
                            <button class="btn btn-primary rounded-pill font-14" (click)="addRow()">Add Form</button>
                          </div>
                        </div>

                        <form class="row g-3" (ngSubmit)="updateCompanyProfile()">


                          <hr>

                          <div class="p-3">
                            <div class="bg-white p-3 rounded">
                              <div class="table-responsive">
                                <table id="formTable" class="table table-bordered">
                                  <thead>
                                    <tr>
                                      <th>Company Name:</th>
                                      <th>Policy Number:</th>
                                      <th>Policy Start Date:</th>
                                      <th>Policy Expiration Date:</th>
                                      <th>Upload Certificate:</th>
                                      <th>Actions</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let entry of companyToEdit.insuranceEntries; let i = index">
                                      <td>
                                        <input type="text" class="form-control" [(ngModel)]="entry.companyName"
                                          name="companyName-{{i}}" required>
                                      </td>
                                      <td>
                                        <input type="text" class="form-control" [(ngModel)]="entry.policyNumber"
                                          name="policyNumber-{{i}}" required>
                                      </td>
                                      <td>
                                        <input type="date" class="form-control" [(ngModel)]="entry.policyStartDate"
                                          name="policyStartDate-{{i}}" required>
                                      </td>
                                      <td>
                                        <input type="date" class="form-control" [(ngModel)]="entry.policyExpirationDate"
                                          name="policyExpirationDate-{{i}}" required>
                                      </td>
                                      <td>
                                        <input type="file" (change)="onRowFileChange($event, i)">
                                        <span *ngIf="insuranceRows[i].insuranceuploadDocument">{{
                                          insuranceRows[i].insuranceuploadDocument.name }}</span>
                                      </td>
                                      <td>
                                        <button class="btn btn-danger rounded-pill font-12"
                                          (click)="deleteRow(i)">Delete</button>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>




                  <div class="modal-footer justify-content-center"
                    style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px; ">
                    <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
                      data-bs-dismiss="offcanvas" aria-label="Close"> Close</button>
                    <button type="submit" class="btn btn-success btn-sm text-uppercase rounded-pill"
                      data-bs-dismiss="offcanvas">Save changes</button>
                    <button type="button" class="btn btn-success btn-sm text-uppercase rounded-pill"
                      (click)="goToSection('compliance-info' , $event)">Next</button>
                  </div>



                </form>
              </div>






              <div class="content_ac" *ngIf="activeSection === 'compliance-info'">
                <h3 class="mb-4">Compliance Documentation</h3>
                <form class="row g-3" (ngSubmit)="updateCompanyProfile()">

                  <div class="row">
                    <!-- US DOT Registration Upload -->
                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="usDOTRegistrationUploadDocument">Upload Document</label>
                        <input type="file" class="form-control" id="usDOTRegistrationUploadDocument"
                          (change)="companyEditFile($event, 'usDOTRegistrationUploadDocument')">
                        <small *ngIf="companyFileNames['usDOTRegistrationUploadDocument']">
                          Selected: {{ companyFileNames['usDOTRegistrationUploadDocument'] }}
                        </small>
                      </div>
                    </div>

                    <!-- MC Certificate Upload -->
                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="mcCertificateUploadDocument">Upload Document</label>
                        <input type="file" class="form-control" id="mcCertificateUploadDocument"
                          (change)="companyEditFile($event, 'mcCertificateUploadDocument')">
                        <small *ngIf="companyFileNames['mcCertificateUploadDocument']">
                          Selected: {{ companyFileNames['mcCertificateUploadDocument'] }}
                        </small>
                      </div>
                    </div>

                    <!-- IFTA Registration Upload -->
                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="mb-2 d-block" for="iftaRegistrationUploadDocument">Upload Document</label>
                        <input type="file" class="form-control" id="iftaRegistrationUploadDocument"
                          (change)="companyEditFile($event, 'iftaRegistrationUploadDocument')">
                        <small *ngIf="companyFileNames['iftaRegistrationUploadDocument']">
                          Selected: {{ companyFileNames['iftaRegistrationUploadDocument'] }}
                        </small>
                      </div>
                    </div>

                    <div class="col-md-6">
                      <label class="mb-2 d-block">Prepass Account Number:</label>
                      <input type="text" class="form-control" id="prepassAccountNumber"
                        [(ngModel)]="companyToEdit['accountsPermits']['prepassAccountNumber']"
                        name="prepassAccountNumber" #prepassAccountNumber="ngModel" required>
                    </div>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">Ifta Account Number:</label>
                      <input type="text" class="form-control" id="iftaAccountNumber"
                        [(ngModel)]="companyToEdit['accountsPermits']['iftaAccountNumber']" name="iftaAccountNumber"
                        #iftaAccountNumber="ngModel" required>
                    </div>
                    <div class="col-md-6">
                      <label class="mb-2 d-block">Ucr Number:</label>
                      <input type="text" class="form-control" id="ucrNumber"
                        [(ngModel)]="companyToEdit['accountsPermits']['ucrNumber']" name="ucrNumber"
                        #ucrNumber="ngModel" required>
                    </div>

                    <div class="modal-footer justify-content-center"
                      style="border-top: 1px solid #ccc; padding-top: 15px; margin-top: 15px;">
                      <button type="button" class="btn btn-outline-secondary btn-sm text-uppercase rounded-pill"
                        data-bs-dismiss="offcanvas" aria-label="Close">Close</button>
                      <button type="submit" class="btn btn-success btn-sm text-uppercase rounded-pill"
                        data-bs-dismiss="offcanvas">SUBMIT FORM</button>
                    </div>

                  </div>

                </form>


              </div>




            </form>
            Â Â 
          </div>
        </div>